<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Rigs of Rods: source/main/rig_editor/RigEditor_Main.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="rorlogo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Rigs of Rods
   
   </div>
   <div id="projectbrief">Soft-body Physics Simulation</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">source/main/rig_editor/RigEditor_Main.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_rig_editor___main_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">    This source file is part of Rigs of Rods</span>
<a name="l00003"></a>00003 <span class="comment">    Copyright 2005-2012 Pierre-Michel Ricordel</span>
<a name="l00004"></a>00004 <span class="comment">    Copyright 2007-2012 Thomas Fischer</span>
<a name="l00005"></a>00005 <span class="comment">    Copyright 2013-2015 Petr Ohlidal</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">    For more information, see http://www.rigsofrods.com/</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">    Rigs of Rods is free software: you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment">    it under the terms of the GNU General Public License version 3, as</span>
<a name="l00011"></a>00011 <span class="comment">    published by the Free Software Foundation.</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">    Rigs of Rods is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l00016"></a>00016 <span class="comment">    GNU General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"></span>
<a name="l00018"></a>00018 <span class="comment">    You should have received a copy of the GNU General Public License</span>
<a name="l00019"></a>00019 <span class="comment">    along with Rigs of Rods. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00020"></a>00020 <span class="comment">*/</span>
<a name="l00021"></a>00021 
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___main_8h.html">RigEditor_Main.h</a>&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="_application_8h.html" title="Central object manager and communications hub.">Application.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="_cache_system_8h.html" title="Caches information about installed mods (vehicles, terrains...)">CacheSystem.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="_global_environment_8h.html">GlobalEnvironment.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_beams_panel_8h.html">GUI_RigEditorBeamsPanel.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_commands2_panel_8h.html">GUI_RigEditorCommands2Panel.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_delete_menu_8h.html">GUI_RigEditorDeleteMenu.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_flex_body_wheels_panel_8h.html">GUI_RigEditorFlexBodyWheelsPanel.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_help_window_8h.html">GUI_RigEditorHelpWindow.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_hydros_panel_8h.html">GUI_RigEditorHydrosPanel.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_land_vehicle_properties_window_8h.html">GUI_RigEditorLandVehiclePropertiesWindow.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_menubar_8h.html">GUI_RigEditorMenubar.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_mesh_wheels2_panel_8h.html">GUI_RigEditorMeshWheels2Panel.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_node_panel_8h.html">GUI_RigEditorNodePanel.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_rig_properties_window_8h.html">GUI_RigEditorRigPropertiesWindow.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_shocks_panel_8h.html">GUI_RigEditorShocksPanel.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i___rig_editor_shocks2_panel_8h.html">GUI_RigEditorShocks2Panel.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="_g_u_i_manager_8h.html">GUIManager.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="_input_engine_8h.html" title="Input logic.">InputEngine.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="_main_thread_8h.html" title="Main thread logic. Manages startup and shutdown etc...">MainThread.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="_ogre_subsystem_8h.html" title="OGRE engine wrapper.">OgreSubsystem.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="_rig_def___parser_8h.html">RigDef_Parser.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="_rig_def___serializer_8h.html">RigDef_Serializer.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="_rig_def___validator_8h.html" title=".truck format validator">RigDef_Validator.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___camera_handler_8h.html">RigEditor_CameraHandler.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___config_8h.html">RigEditor_Config.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___input_handler_8h.html">RigEditor_InputHandler.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___node_8h.html">RigEditor_Node.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___rig_8h.html">RigEditor_Rig.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___rig_properties_8h.html">RigEditor_RigProperties.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___rig_elements_aggregate_data_8h.html">RigEditor_RigElementsAggregateData.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="_rig_editor___rig_wheels_aggregate_data_8h.html">RigEditor_RigWheelsAggregateData.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="_settings_8h.html">Settings.h</a>&quot;</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;OISKeyboard.h&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;OgreEntity.h&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &lt;OgreMaterialManager.h&gt;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &lt;OgreMaterial.h&gt;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &lt;OgreMovableObject.h&gt;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &lt;OgreRoot.h&gt;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &lt;OgreRenderWindow.h&gt;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="keyword">using namespace </span>RoR;
<a name="l00073"></a>00073 <span class="keyword">using namespace </span>RoR::RigEditor;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="keyword">const</span> MyGUI::UString Main::OpenSaveFileDialogMode::MODE_OPEN_TRUCK     (<span class="stringliteral">&quot;RigEditor_OpenTruckFile&quot;</span>);
<a name="l00076"></a>00076 <span class="keyword">const</span> MyGUI::UString Main::OpenSaveFileDialogMode::MODE_SAVE_TRUCK_AS  (<span class="stringliteral">&quot;RigEditor_SaveTruckFileAs&quot;</span>);
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a617555d8288d021b0fe261d9df84a94a">00078</a> Main::Main(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html">Config</a>* config):
<a name="l00079"></a>00079     m_config(config),
<a name="l00080"></a>00080     m_scene_manager(nullptr),
<a name="l00081"></a>00081     m_camera(nullptr),
<a name="l00082"></a>00082     m_viewport(nullptr),
<a name="l00083"></a>00083     m_rig_entity(nullptr),
<a name="l00084"></a>00084     m_exit_loop_requested(false),
<a name="l00085"></a>00085     m_input_handler(nullptr),
<a name="l00086"></a>00086     m_debug_box(nullptr),
<a name="l00087"></a>00087     m_rig(nullptr),
<a name="l00088"></a>00088     m_state_flags(0)
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090     <span class="comment">/* Setup 3D engine */</span>
<a name="l00091"></a>00091     <a class="code" href="class_ro_r_1_1_ogre_subsystem.html">OgreSubsystem</a>* ror_ogre_subsystem = <a class="code" href="class_ro_r_1_1_application.html#a5082701abd55926b3c6eb4b0c933eca5">RoR::Application::GetOgreSubsystem</a>();
<a name="l00092"></a>00092     assert(ror_ogre_subsystem != <span class="keyword">nullptr</span>);
<a name="l00093"></a>00093     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a> = ror_ogre_subsystem-&gt;<a class="code" href="class_ro_r_1_1_ogre_subsystem.html#a2f68e736be01d118cae03e831b38a9df">GetOgreRoot</a>()-&gt;createSceneManager(Ogre::ST_GENERIC, <span class="stringliteral">&quot;rig_editor_scene_manager&quot;</span>);
<a name="l00094"></a>00094     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;setAmbientLight(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#ab79e1eb5db50811706a5596c184b4f36">scene_ambient_light_color</a>);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     <span class="comment">/* Camera */</span>
<a name="l00097"></a>00097     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a> = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;createCamera(<span class="stringliteral">&quot;rig_editor_camera&quot;</span>);
<a name="l00098"></a>00098     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;setNearClipDistance(config-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#a46d6746d4025be9a86c057a9519e9fb6">camera_near_clip_distance</a>);
<a name="l00099"></a>00099     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;setFarClipDistance(config-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#abe0783d5287c7ebe52dff5124de5cb75">camera_far_clip_distance</a>);
<a name="l00100"></a>00100     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;setFOVy(Ogre::Degree(config-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#a26eee13a894b279ea8d6294d0893d579">camera_FOVy_degrees</a>));
<a name="l00101"></a>00101     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;setAutoAspectRatio(<span class="keyword">true</span>);
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="comment">/* Setup input */</span>
<a name="l00104"></a>00104     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a> = <span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html">InputHandler</a>();
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     <span class="comment">/* Camera handling */</span>
<a name="l00107"></a>00107     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a> = <span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html">CameraHandler</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>);
<a name="l00108"></a>00108     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#af540dff2565986c89085e344ad40977c">SetOrbitTarget</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;getRootSceneNode());  
<a name="l00109"></a>00109     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#a4fc8f003469b5d9438c41ad906678bd5">SetOrthoZoomRatio</a>(config-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#a2f8f20003798294de84ebafa715b8b94">ortho_camera_zoom_ratio</a>);
<a name="l00110"></a>00110     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;setPosition(Ogre::Vector3(10,5,10));
<a name="l00111"></a>00111 
<a name="l00112"></a>00112     <span class="comment">/* Debug output box */</span>
<a name="l00113"></a>00113     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#adf7388b0c4242dd9d3d2a9e728fa9ee6">m_debug_box</a> = MyGUI::Gui::getInstance().createWidget&lt;MyGUI::TextBox&gt;
<a name="l00114"></a>00114         (<span class="stringliteral">&quot;TextBox&quot;</span>, 10, 30, 400, 100, MyGUI::Align::Top, <span class="stringliteral">&quot;Main&quot;</span>, <span class="stringliteral">&quot;rig_editor_quick_debug_text_box&quot;</span>);
<a name="l00115"></a>00115     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#adf7388b0c4242dd9d3d2a9e728fa9ee6">m_debug_box</a>-&gt;setCaption(<span class="stringliteral">&quot;Hello\nRigEditor!&quot;</span>);
<a name="l00116"></a>00116     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#adf7388b0c4242dd9d3d2a9e728fa9ee6">m_debug_box</a>-&gt;setTextColour(MyGUI::Colour(0.8, 0.8, 0.8));
<a name="l00117"></a>00117     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#adf7388b0c4242dd9d3d2a9e728fa9ee6">m_debug_box</a>-&gt;setFontName(<span class="stringliteral">&quot;DefaultBig&quot;</span>);
<a name="l00118"></a>00118 }
<a name="l00119"></a>00119 
<a name="l00120"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a58d9c0798f0d2114e736d04d780a080f">00120</a> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a58d9c0798f0d2114e736d04d780a080f">Main::~Main</a>()
<a name="l00121"></a>00121 {
<a name="l00122"></a>00122     <span class="comment">// GUI objects are cleaned up by std::unique_ptr</span>
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l00125"></a>00125     {
<a name="l00126"></a>00126         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a0c8298efe94e90610d03cfb403614701">DetachFromScene</a>();
<a name="l00127"></a>00127         <span class="keyword">delete</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>;
<a name="l00128"></a>00128         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> = <span class="keyword">nullptr</span>;
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8cd11f0150b5e247b6d9f00212d42b0d">00132</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8cd11f0150b5e247b6d9f00212d42b0d">Main::EnterMainLoop</a>()
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134     <span class="comment">/* Setup 3D engine */</span>
<a name="l00135"></a>00135     <a class="code" href="class_ro_r_1_1_ogre_subsystem.html">OgreSubsystem</a>* ror_ogre_subsystem = <a class="code" href="class_ro_r_1_1_application.html#a5082701abd55926b3c6eb4b0c933eca5">RoR::Application::GetOgreSubsystem</a>();
<a name="l00136"></a>00136     assert(ror_ogre_subsystem != <span class="keyword">nullptr</span>);
<a name="l00137"></a>00137     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4c2da7088e0076508c75356ececc5e9d">m_viewport</a> = ror_ogre_subsystem-&gt;<a class="code" href="class_ro_r_1_1_ogre_subsystem.html#aec5be99797f9add72578fb1fbfec582f">GetRenderWindow</a>()-&gt;addViewport(<span class="keyword">nullptr</span>);
<a name="l00138"></a>00138     <span class="keywordtype">int</span> viewport_width = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4c2da7088e0076508c75356ececc5e9d">m_viewport</a>-&gt;getActualWidth();
<a name="l00139"></a>00139     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4c2da7088e0076508c75356ececc5e9d">m_viewport</a>-&gt;setBackgroundColour(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#a9919cf33e0328b03d45dc449c4638ee3">viewport_background_color</a>);
<a name="l00140"></a>00140     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;setAspectRatio(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4c2da7088e0076508c75356ececc5e9d">m_viewport</a>-&gt;getActualHeight() / viewport_width);
<a name="l00141"></a>00141     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4c2da7088e0076508c75356ececc5e9d">m_viewport</a>-&gt;setCamera(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1185efd5764badfe2d8ed84661c7890b">InitializeOrRestoreGui</a>();
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <span class="comment">/* Setup input */</span>
<a name="l00146"></a>00146     <a class="code" href="class_ro_r_1_1_application.html#a608003a20ef939a79437a9da8fa76307">RoR::Application::GetInputEngine</a>()-&gt;<a class="code" href="class_input_engine.html#a0a7547961b0086f723d6dbe7e876c582">SetKeyboardListener</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>);
<a name="l00147"></a>00147     <a class="code" href="class_ro_r_1_1_application.html#a608003a20ef939a79437a9da8fa76307">RoR::Application::GetInputEngine</a>()-&gt;<a class="code" href="class_input_engine.html#aae01cbeb62aa3577f7f4b19337c02383">SetMouseListener</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="comment">/* Show debug box */</span>
<a name="l00150"></a>00150     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#adf7388b0c4242dd9d3d2a9e728fa9ee6">m_debug_box</a>-&gt;setVisible(<span class="keyword">true</span>);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="keywordflow">while</span> (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ae78aa7f3aaffa331367d99488458b8b3">m_exit_loop_requested</a>)
<a name="l00153"></a>00153     {
<a name="l00154"></a>00154         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#abe2179248ae5a8d9fc4a8ed136a18c46">UpdateMainLoop</a>();
<a name="l00155"></a>00155 
<a name="l00156"></a>00156         Ogre::RenderWindow* rw = <a class="code" href="class_ro_r_1_1_application.html#a5082701abd55926b3c6eb4b0c933eca5">RoR::Application::GetOgreSubsystem</a>()-&gt;<a class="code" href="class_ro_r_1_1_ogre_subsystem.html#aec5be99797f9add72578fb1fbfec582f">GetRenderWindow</a>();
<a name="l00157"></a>00157         <span class="keywordflow">if</span> (rw-&gt;isClosed())
<a name="l00158"></a>00158         {
<a name="l00159"></a>00159             <a class="code" href="class_ro_r_1_1_application.html#ac5b228d074e3252101179a88c21fcb92">RoR::Application::GetMainThreadLogic</a>()-&gt;<a class="code" href="class_ro_r_1_1_main_thread.html#acafb56bf2181a19e00f4b66244b519c9">RequestShutdown</a>();
<a name="l00160"></a>00160             <span class="keywordflow">break</span>;
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163         <span class="comment">/* Render */</span>
<a name="l00164"></a>00164         <a class="code" href="class_ro_r_1_1_application.html#a5082701abd55926b3c6eb4b0c933eca5">RoR::Application::GetOgreSubsystem</a>()-&gt;<a class="code" href="class_ro_r_1_1_ogre_subsystem.html#a2f68e736be01d118cae03e831b38a9df">GetOgreRoot</a>()-&gt;renderOneFrame();
<a name="l00165"></a>00165 
<a name="l00166"></a>00166         <span class="keywordflow">if</span> (!rw-&gt;isActive() &amp;&amp; rw-&gt;isVisible())
<a name="l00167"></a>00167         {
<a name="l00168"></a>00168             rw-&gt;update(); <span class="comment">// update even when in background !</span>
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172     <span class="comment">/* Hide GUI */</span>
<a name="l00173"></a>00173     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a>-&gt;Hide();
<a name="l00174"></a>00174     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;isModal())
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;endModal(); <span class="comment">// Hides the dialog</span>
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;Hide();
<a name="l00179"></a>00179     <span class="comment">// Supress node/beam panels (if visible)</span>
<a name="l00180"></a>00180     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3ed0196a93a820038f9258ff7a622176">m_nodes_panel</a>    -&gt;HideTemporarily();
<a name="l00181"></a>00181     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>    -&gt;HideTemporarily();
<a name="l00182"></a>00182     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5c72131f5585feb3b96a28e7a24322e0">m_hydros_panel</a>   -&gt;HideTemporarily();
<a name="l00183"></a>00183     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af93ee5801a690e1e5fcacbda4d4e9402">m_commands2_panel</a>-&gt;HideTemporarily();
<a name="l00184"></a>00184     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5d7f13c7fda0e660cae9724f8fa6cf5f">m_shocks_panel</a>   -&gt;HideTemporarily();
<a name="l00185"></a>00185     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad71ab5304e4c5022a7331c29c6dac8cf">m_shocks2_panel</a>  -&gt;HideTemporarily();
<a name="l00186"></a>00186     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>     -&gt;HideTemporarily();
<a name="l00187"></a>00187     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>  -&gt;HideTemporarily();
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     <span class="comment">/* Hide debug box */</span>
<a name="l00190"></a>00190     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#adf7388b0c4242dd9d3d2a9e728fa9ee6">m_debug_box</a>-&gt;setVisible(<span class="keyword">false</span>);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ae78aa7f3aaffa331367d99488458b8b3">m_exit_loop_requested</a> = <span class="keyword">false</span>;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#abe2179248ae5a8d9fc4a8ed136a18c46">00195</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#abe2179248ae5a8d9fc4a8ed136a18c46">Main::UpdateMainLoop</a>()
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197     <span class="comment">/* Process window events */</span>
<a name="l00198"></a>00198 <span class="preprocessor">#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32 || OGRE_PLATFORM == OGRE_PLATFORM_LINUX</span>
<a name="l00199"></a>00199 <span class="preprocessor"></span>    RoRWindowEventUtilities::messagePump();
<a name="l00200"></a>00200 <span class="preprocessor">#endif</span>
<a name="l00201"></a>00201 <span class="preprocessor"></span>
<a name="l00202"></a>00202     <span class="comment">/* Update input events */</span>
<a name="l00203"></a>00203     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#ab7f05e2f388d1e0a46610122b072b6ac">ResetEvents</a>();
<a name="l00204"></a>00204     <a class="code" href="class_ro_r_1_1_application.html#a608003a20ef939a79437a9da8fa76307">RoR::Application::GetInputEngine</a>()-&gt;<a class="code" href="class_input_engine.html#a7e30f2d1d86a20caba80ead350269431">Capture</a>(); <span class="comment">// Also injects input to GUI (through RigEditor::InputHandler)</span>
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="comment">/* Handle key presses */</span>
<a name="l00207"></a>00207     <span class="keywordtype">bool</span> camera_ortho_toggled = <span class="keyword">false</span>;
<a name="l00208"></a>00208     <span class="keywordtype">int</span> camera_view_changed = <span class="keyword">false</span>;
<a name="l00209"></a>00209     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#ab8f1a75d8aec2c927c208a6292ec804d">InputHandler::Event::CAMERA_VIEW_TOGGLE_PERSPECTIVE</a>))
<a name="l00210"></a>00210     {
<a name="l00211"></a>00211         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#ae7775e3b33d2606a334f7628b56c35d3">ToggleOrtho</a>();
<a name="l00212"></a>00212         camera_ortho_toggled = <span class="keyword">true</span>;
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="comment">// Orientation:</span>
<a name="l00216"></a>00216     <span class="comment">// Front-&gt;Back = X axis</span>
<a name="l00217"></a>00217     <span class="comment">// Right-&gt;Left = Z axis</span>
<a name="l00218"></a>00218     <span class="comment">// Top-&gt;Down   = Y axis negative</span>
<a name="l00219"></a>00219     <span class="comment">// Inspired by:</span>
<a name="l00220"></a>00220     <span class="comment">// * Gavril MZ2</span>
<a name="l00221"></a>00221     <span class="comment">// * Tatra-T813-Dakar.truck</span>
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     OIS::Keyboard* ois_keyboard = <a class="code" href="class_ro_r_1_1_application.html#a608003a20ef939a79437a9da8fa76307">RoR::Application::GetInputEngine</a>()-&gt;<a class="code" href="class_input_engine.html#af263ae461520389d934f5f13b43aeb84">GetOisKeyboard</a>();
<a name="l00224"></a>00224     <span class="keywordtype">bool</span> ctrl_is_down = ois_keyboard-&gt;isKeyDown(OIS::KC_RCONTROL) || ois_keyboard-&gt;isKeyDown(OIS::KC_LCONTROL);
<a name="l00225"></a>00225     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#ac4e36e85979afe1fff39cc6541085058">InputHandler::Event::CAMERA_VIEW_FRONT</a>))
<a name="l00226"></a>00226     {
<a name="l00227"></a>00227         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#ac67188900628f482e2af0bc59f05d5e1">LookInDirection</a>(ctrl_is_down ? Ogre::Vector3::NEGATIVE_UNIT_X : Ogre::Vector3::UNIT_X);
<a name="l00228"></a>00228         camera_view_changed = <span class="keyword">true</span>;
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#afbc9674d6ab44de8a94b138974e4c78a">InputHandler::Event::CAMERA_VIEW_SIDE</a>))
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#ac67188900628f482e2af0bc59f05d5e1">LookInDirection</a>(ctrl_is_down ? Ogre::Vector3::UNIT_Z : Ogre::Vector3::NEGATIVE_UNIT_Z);
<a name="l00233"></a>00233         camera_view_changed = <span class="keyword">true</span>;
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#a9cbf5b294714bbf5c42f6d426c9d681d">InputHandler::Event::CAMERA_VIEW_TOP</a>))
<a name="l00236"></a>00236     {
<a name="l00237"></a>00237         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#ab5b51c84b50c30dd85a3587e8682ae89">TopView</a>(! ctrl_is_down);
<a name="l00238"></a>00238         camera_view_changed = <span class="keyword">true</span>;
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     <span class="comment">/* Handle camera control */</span>
<a name="l00242"></a>00242     
<a name="l00243"></a>00243     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#ac2a0c872624beaa8ae4048a2e8312a6e">HasMoved</a>() || <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#abdaec9f5cf3e85b7ba10415e82789b67">HasScrolled</a>())
<a name="l00244"></a>00244     {
<a name="l00245"></a>00245         <span class="keywordtype">bool</span> res = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#af4012a17414adf6e59e59a001754b8a7">InjectMouseMove</a>(
<a name="l00246"></a>00246             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a76f5174c481e58c02936e10b8dd39a0d">GetMouseButtonEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_button_event.html#af243a237899c05ecb77ee29d2fcdda53">IsRightButtonDown</a>(), <span class="comment">/* (bool do_orbit) */</span>
<a name="l00247"></a>00247             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#af9cde0bb14f0d85d9e5f218106ced1da">rel_x</a>,
<a name="l00248"></a>00248             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#af3daea0cfccc28d32561055f1292f80e">rel_y</a>,
<a name="l00249"></a>00249             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#a81dfa83dcaa6e442de456e10ba4a50b9">rel_wheel</a>
<a name="l00250"></a>00250         );
<a name="l00251"></a>00251         <span class="keywordflow">if</span> (res)
<a name="l00252"></a>00252         {
<a name="l00253"></a>00253             camera_view_changed = <span class="keyword">true</span>;
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255     }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="comment">// RIG MANIPULATION \\</span>
<a name="l00258"></a>00258 <span class="comment"></span>
<a name="l00259"></a>00259     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l00260"></a>00260     {
<a name="l00261"></a>00261         <span class="keywordtype">bool</span> node_selection_changed = <span class="keyword">false</span>;
<a name="l00262"></a>00262         <span class="keywordtype">bool</span> node_hover_changed = <span class="keyword">false</span>;
<a name="l00263"></a>00263         <span class="keywordtype">bool</span> node_mouse_selecting_disabled = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;IsVisible();<span class="comment">// || m_gui_rig_properties_window-&gt;IsVisible();</span>
<a name="l00264"></a>00264         <span class="keywordtype">bool</span> rig_updated = <span class="keyword">false</span>;
<a name="l00265"></a>00265         <span class="keywordtype">bool</span> all_nodes_selection_toggled = <span class="keyword">false</span>;
<a name="l00266"></a>00266         <span class="keywordtype">bool</span> rig_must_deselect_all_nodes = <span class="keyword">false</span>;
<a name="l00267"></a>00267         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_node.html">RigEditor::Node</a>* node_to_set_selected = <span class="keyword">nullptr</span>;
<a name="l00268"></a>00268         <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_vector2t.html">Vector2int</a> mouse_screen_position = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#acc2ecfe055276ffcc2c6dd7c59f85bfa">GetAbsolutePosition</a>();
<a name="l00269"></a>00269 
<a name="l00270"></a>00270         <span class="comment">// Handle event &#39;extrude selected&#39;, because it changes selection and invokes Mode::GRAB_NODES</span>
<a name="l00271"></a>00271         <span class="comment">// TODO: Make this work with GUI panel updates. It will require implementing array of nodes to set selected.</span>
<a name="l00272"></a>00272         <span class="keywordflow">if</span>  (   (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#a84240c544ab939943d3354fc26de10a1">InputHandler::Event::NODES_EXTRUDE_SELECTED</a>))
<a name="l00273"></a>00273             &amp;&amp;  (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a07a1c22e3267675d2345e95b5e8bfa4a">IsModeActive</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#a7aaf90250753364955f131fa1c6d5ca0">InputHandler::Mode::CREATE_NEW_NODE</a>))
<a name="l00274"></a>00274             &amp;&amp;  (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a07a1c22e3267675d2345e95b5e8bfa4a">IsModeActive</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>))
<a name="l00275"></a>00275             )
<a name="l00276"></a>00276         {
<a name="l00277"></a>00277             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a3c57ce426944230414c3b6bc6afad637">ExtrudeSelectedNodes</a>();
<a name="l00278"></a>00278             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a95c3e741dd892038f274653bc65c1f03">EnterMode</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>);
<a name="l00279"></a>00279         }
<a name="l00280"></a>00280         
<a name="l00281"></a>00281         <span class="keywordflow">if</span>  (   (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#ade16b927f3b258ef250abce84cc2f33f">WasModeEntered</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#a7aaf90250753364955f131fa1c6d5ca0">InputHandler::Mode::CREATE_NEW_NODE</a>))
<a name="l00282"></a>00282             ||  (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#ade16b927f3b258ef250abce84cc2f33f">WasModeEntered</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>))
<a name="l00283"></a>00283             )
<a name="l00284"></a>00284         {
<a name="l00285"></a>00285             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a7cdf87ac9c9e18c044ed1ab6d5248594">ClearMouseHoveredNode</a>();
<a name="l00286"></a>00286             node_hover_changed = <span class="keyword">true</span>;
<a name="l00287"></a>00287             node_mouse_selecting_disabled = <span class="keyword">true</span>;
<a name="l00288"></a>00288         }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290         <span class="comment">// The &#39;delete menu&#39; dialog</span>
<a name="l00291"></a>00291         <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#ae986c715d634dc10851faa83d4f8bc8b">InputHandler::Event::GUI_SHOW_DELETE_MENU</a>))
<a name="l00292"></a>00292         {
<a name="l00293"></a>00293             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;Show();
<a name="l00294"></a>00294             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;SetPosition(
<a name="l00295"></a>00295                     mouse_screen_position.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_vector2t.html#a5732df3810a0b56cdf82055ed1076232">x</a> + <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#a21bfd3cf6094385c0933e1054a382723">gui_dialog_delete_placement_x_px</a>,
<a name="l00296"></a>00296                     mouse_screen_position.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_vector2t.html#ac86ec22a09989a2beb251494c98eaf68">y</a> + <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#a382fb57166aad29745a0e727a211adb7">gui_dialog_delete_placement_y_px</a>
<a name="l00297"></a>00297                 );
<a name="l00298"></a>00298         }
<a name="l00299"></a>00299         <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;IsVisible())
<a name="l00300"></a>00300         {
<a name="l00301"></a>00301             <span class="keywordflow">if</span> (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;TestCursorInRange(mouse_screen_position.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_vector2t.html#a5732df3810a0b56cdf82055ed1076232">x</a>, mouse_screen_position.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_vector2t.html#ac86ec22a09989a2beb251494c98eaf68">y</a>, <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#ab152969954c018dad1cf321ab83ab6ab">gui_dialog_delete_cursor_fence_px</a>))
<a name="l00302"></a>00302             {
<a name="l00303"></a>00303                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;Hide();
<a name="l00304"></a>00304             }
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         <span class="comment">// Deselect/select all nodes</span>
<a name="l00308"></a>00308         <span class="keywordflow">if</span>  (   (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#a06e60e0e776ee9f4151cb25feab3c123">InputHandler::Event::NODES_DESELECT_OR_SELECT_ALL</a>))
<a name="l00309"></a>00309             &amp;&amp;  (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a07a1c22e3267675d2345e95b5e8bfa4a">IsModeActive</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#a7aaf90250753364955f131fa1c6d5ca0">InputHandler::Mode::CREATE_NEW_NODE</a>))
<a name="l00310"></a>00310             &amp;&amp;  (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a07a1c22e3267675d2345e95b5e8bfa4a">IsModeActive</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>))
<a name="l00311"></a>00311             )
<a name="l00312"></a>00312         {
<a name="l00313"></a>00313             all_nodes_selection_toggled = <span class="keyword">true</span>;
<a name="l00314"></a>00314             node_selection_changed = <span class="keyword">true</span>;
<a name="l00315"></a>00315         }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317         <span class="comment">// Creating new nodes with mouse</span>
<a name="l00318"></a>00318         <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a07a1c22e3267675d2345e95b5e8bfa4a">IsModeActive</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#a7aaf90250753364955f131fa1c6d5ca0">InputHandler::Mode::CREATE_NEW_NODE</a>))
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320             node_mouse_selecting_disabled = <span class="keyword">true</span>;
<a name="l00321"></a>00321             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a76f5174c481e58c02936e10b8dd39a0d">GetMouseButtonEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_button_event.html#a97b53293043b1f141212aaa61590eb23">WasLeftButtonPressed</a>())
<a name="l00322"></a>00322             {
<a name="l00323"></a>00323                 <span class="keywordflow">if</span> (! ctrl_is_down)
<a name="l00324"></a>00324                 {
<a name="l00325"></a>00325                     rig_must_deselect_all_nodes = <span class="keyword">true</span>;
<a name="l00326"></a>00326                     node_selection_changed = <span class="keyword">true</span>;
<a name="l00327"></a>00327                 }
<a name="l00328"></a>00328                 node_to_set_selected = &amp;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a9b03472fe7e8b7d0aebba72c14a5af5e">CreateNewNode</a>(
<a name="l00329"></a>00329                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#a83f1c10cee3202fa2ab8a14636d15239">ConvertScreenToWorldPosition</a>(mouse_screen_position, Ogre::Vector3::ZERO)
<a name="l00330"></a>00330                     );
<a name="l00331"></a>00331                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ae0f2af92699b413199c31438dd41b84b">RefreshNodeScreenPosition</a>(*node_to_set_selected, <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>);
<a name="l00332"></a>00332                 node_selection_changed = <span class="keyword">true</span>;
<a name="l00333"></a>00333                 rig_updated = <span class="keyword">true</span>;
<a name="l00334"></a>00334             }
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="comment">// Grabbing nodes with mouse</span>
<a name="l00338"></a>00338         <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a07a1c22e3267675d2345e95b5e8bfa4a">IsModeActive</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>))
<a name="l00339"></a>00339         {
<a name="l00340"></a>00340             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#ac2a0c872624beaa8ae4048a2e8312a6e">HasMoved</a>())
<a name="l00341"></a>00341             {
<a name="l00342"></a>00342                 <span class="comment">// Translate selected nodes</span>
<a name="l00343"></a>00343                 Ogre::Vector3 mouse_world_pos = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#a83f1c10cee3202fa2ab8a14636d15239">ConvertScreenToWorldPosition</a>(mouse_screen_position, Ogre::Vector3::ZERO);
<a name="l00344"></a>00344                 Ogre::Vector3 previous_world_pos = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_camera_handler.html#a83f1c10cee3202fa2ab8a14636d15239">ConvertScreenToWorldPosition</a>(
<a name="l00345"></a>00345                     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#a85375797aa6942d5e5c596c13aa752fd">GetPreviousAbsolutePosition</a>(),
<a name="l00346"></a>00346                     Ogre::Vector3::ZERO
<a name="l00347"></a>00347                 );
<a name="l00348"></a>00348 
<a name="l00349"></a>00349                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a62c070427e93976b8fc5a11b09b6076d">TranslateSelectedNodes</a>(mouse_world_pos - previous_world_pos, <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>);
<a name="l00350"></a>00350                 rig_updated = <span class="keyword">true</span>;
<a name="l00351"></a>00351             }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a76f5174c481e58c02936e10b8dd39a0d">GetMouseButtonEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_button_event.html#a97b53293043b1f141212aaa61590eb23">WasLeftButtonPressed</a>())
<a name="l00354"></a>00354             {
<a name="l00355"></a>00355                 <span class="comment">// Exit grab mode and commit changes</span>
<a name="l00356"></a>00356                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a774705870c17468f80ef85bfc426a20b">ExitMode</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>);
<a name="l00357"></a>00357                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a4d3922eb1fb33cc1e653d863f241c04c">SelectedNodesCommitPositionUpdates</a>();
<a name="l00358"></a>00358             }
<a name="l00359"></a>00359             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a78bd04ddb2f307eee148c0ee2dc1bb3b">WasEventFired</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_event.html#a41fee14cb16376cdb53450149ebdda01">InputHandler::Event::ESCAPE</a>))
<a name="l00360"></a>00360             {
<a name="l00361"></a>00361                 <span class="comment">// Exit grab mode and revert changes</span>
<a name="l00362"></a>00362                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a774705870c17468f80ef85bfc426a20b">ExitMode</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>);
<a name="l00363"></a>00363                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a005f40c9e0cf3867bcdbe5f971ffae87">SelectedNodesCancelPositionUpdates</a>();
<a name="l00364"></a>00364                 rig_updated = <span class="keyword">true</span>;
<a name="l00365"></a>00365             }
<a name="l00366"></a>00366         }
<a name="l00367"></a>00367         
<a name="l00368"></a>00368 
<a name="l00369"></a>00369         <span class="keywordflow">if</span> (camera_view_changed || camera_ortho_toggled)
<a name="l00370"></a>00370         {
<a name="l00371"></a>00371             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a0a03055933371812797a04a1353479f1">RefreshAllNodesScreenPositions</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>);
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373         
<a name="l00374"></a>00374         <span class="keywordflow">if</span>  (   (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a8246833005bc458ddc0df02e6b04812d">WasModeExited</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#a7aaf90250753364955f131fa1c6d5ca0">InputHandler::Mode::CREATE_NEW_NODE</a>))
<a name="l00375"></a>00375             ||  (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a8246833005bc458ddc0df02e6b04812d">WasModeExited</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>))
<a name="l00376"></a>00376             ||  (   (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a07a1c22e3267675d2345e95b5e8bfa4a">IsModeActive</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#a7aaf90250753364955f131fa1c6d5ca0">InputHandler::Mode::CREATE_NEW_NODE</a>))
<a name="l00377"></a>00377                 &amp;&amp;  ((<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#ac2a0c872624beaa8ae4048a2e8312a6e">HasMoved</a>() || camera_view_changed || camera_ortho_toggled))
<a name="l00378"></a>00378                 )
<a name="l00379"></a>00379             )
<a name="l00380"></a>00380         {
<a name="l00381"></a>00381             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a7903b41d8fc63f6d73a4834f19209914">RefreshMouseHoveredNode</a>(mouse_screen_position))
<a name="l00382"></a>00382             {
<a name="l00383"></a>00383                 node_hover_changed = <span class="keyword">true</span>;
<a name="l00384"></a>00384             }
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         <span class="comment">// Selecting nodes with LMB</span>
<a name="l00388"></a>00388         <span class="keywordflow">if</span>  (   (! node_mouse_selecting_disabled) 
<a name="l00389"></a>00389             &amp;&amp;  (! node_hover_changed) 
<a name="l00390"></a>00390             &amp;&amp;  (! <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a8246833005bc458ddc0df02e6b04812d">WasModeExited</a>(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mode.html#ad63c3b99e58af532a19a1c021c21bf18">InputHandler::Mode::GRAB_NODES</a>))
<a name="l00391"></a>00391             &amp;&amp;  (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a76f5174c481e58c02936e10b8dd39a0d">GetMouseButtonEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_button_event.html#a97b53293043b1f141212aaa61590eb23">WasLeftButtonPressed</a>())
<a name="l00392"></a>00392             )
<a name="l00393"></a>00393         {
<a name="l00394"></a>00394             <span class="keywordflow">if</span> (! ctrl_is_down)
<a name="l00395"></a>00395             {
<a name="l00396"></a>00396                 rig_must_deselect_all_nodes = <span class="keyword">true</span>;
<a name="l00397"></a>00397                 node_selection_changed = <span class="keyword">true</span>;
<a name="l00398"></a>00398             }
<a name="l00399"></a>00399             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#aec363f09d649f122493c7f93558076e1">GetMouseHoveredNode</a>() != <span class="keyword">nullptr</span>)
<a name="l00400"></a>00400             {
<a name="l00401"></a>00401                 node_selection_changed = <span class="keyword">true</span>;
<a name="l00402"></a>00402                 node_to_set_selected = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#aec363f09d649f122493c7f93558076e1">GetMouseHoveredNode</a>();
<a name="l00403"></a>00403             }
<a name="l00404"></a>00404         }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406         <span class="keywordflow">if</span> (node_selection_changed)
<a name="l00407"></a>00407         {
<a name="l00408"></a>00408             <span class="comment">// ==== Apply changes from GUI to rig ====</span>
<a name="l00409"></a>00409 
<a name="l00410"></a>00410             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3ed0196a93a820038f9258ff7a622176">m_nodes_panel</a>-&gt;GetData()-&gt;num_selected != 0)
<a name="l00411"></a>00411             {
<a name="l00412"></a>00412                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#acf591ddaa7076f04007851ad52e4c2b5">SelectedNodesUpdateAttributes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3ed0196a93a820038f9258ff7a622176">m_nodes_panel</a>-&gt;GetData());
<a name="l00413"></a>00413                 <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#af480e3af8684dbb38f78d01c3232a3e6">GetNumSelectedBeams</a>() != 0)
<a name="l00414"></a>00414                 {
<a name="l00415"></a>00415                     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;HasMixedBeamTypes())
<a name="l00416"></a>00416                     {
<a name="l00417"></a>00417                         <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_mixed_beams_aggregate_data.html">MixedBeamsAggregateData</a> data;
<a name="l00418"></a>00418                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;GetMixedBeamsData(&amp;data);
<a name="l00419"></a>00419                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a3ecc59a5f44f8b27ecc5f2bc66f21a38">SelectedMixedBeamsUpdateAttributes</a>(&amp;data);
<a name="l00420"></a>00420                     }
<a name="l00421"></a>00421                     <span class="keywordflow">else</span>
<a name="l00422"></a>00422                     {
<a name="l00423"></a>00423                         <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;GetPlainBeamsData()-&gt;num_selected != 0)
<a name="l00424"></a>00424                         {
<a name="l00425"></a>00425                             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ab26eeed75a6c2d466b38dda6a6a33bf6">SelectedPlainBeamsUpdateAttributes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;GetPlainBeamsData());
<a name="l00426"></a>00426                         }
<a name="l00427"></a>00427                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5d7f13c7fda0e660cae9724f8fa6cf5f">m_shocks_panel</a>-&gt;GetShocksData()-&gt;num_selected != 0)
<a name="l00428"></a>00428                         {
<a name="l00429"></a>00429                             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ad9eaca4efbd4e8cd82068ec443930855">SelectedShocksUpdateAttributes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5d7f13c7fda0e660cae9724f8fa6cf5f">m_shocks_panel</a>-&gt;GetShocksData());
<a name="l00430"></a>00430                         }
<a name="l00431"></a>00431                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad71ab5304e4c5022a7331c29c6dac8cf">m_shocks2_panel</a>-&gt;GetShocks2Data()-&gt;num_selected != 0)
<a name="l00432"></a>00432                         {
<a name="l00433"></a>00433                             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a27e7ce8036ce00f6f291430fe7501fd0">SelectedShocks2UpdateAttributes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad71ab5304e4c5022a7331c29c6dac8cf">m_shocks2_panel</a>-&gt;GetShocks2Data());
<a name="l00434"></a>00434                         }
<a name="l00435"></a>00435                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5c72131f5585feb3b96a28e7a24322e0">m_hydros_panel</a>-&gt;GetHydrosData()-&gt;num_selected != 0)
<a name="l00436"></a>00436                         {
<a name="l00437"></a>00437                             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a793f76a955eb9502b4b27aa3a7518faa">SelectedHydrosUpdateAttributes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5c72131f5585feb3b96a28e7a24322e0">m_hydros_panel</a>-&gt;GetHydrosData());
<a name="l00438"></a>00438                         }
<a name="l00439"></a>00439                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af93ee5801a690e1e5fcacbda4d4e9402">m_commands2_panel</a>-&gt;GetCommands2Data()-&gt;num_selected != 0)
<a name="l00440"></a>00440                         {
<a name="l00441"></a>00441                             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ab9b0d933fd613ade496b73b2bffb6a7c">SelectedCommands2UpdateAttributes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af93ee5801a690e1e5fcacbda4d4e9402">m_commands2_panel</a>-&gt;GetCommands2Data());
<a name="l00442"></a>00442                         }
<a name="l00443"></a>00443                     }       
<a name="l00444"></a>00444                 }
<a name="l00445"></a>00445             }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4e9ceeb031f661d90ee6220ffc994377">HideAllNodeBeamGuiPanels</a>(); <span class="comment">// Reset GUI</span>
<a name="l00448"></a>00448 
<a name="l00449"></a>00449             <span class="comment">// ==== Perform rig selection updates ====</span>
<a name="l00450"></a>00450             <span class="keywordflow">if</span> (all_nodes_selection_toggled)
<a name="l00451"></a>00451             {
<a name="l00452"></a>00452                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a978b98d7cffb97013e63fea8fd93a0da">DeselectOrSelectAllNodes</a>();
<a name="l00453"></a>00453             }
<a name="l00454"></a>00454             <span class="keywordflow">if</span> (rig_must_deselect_all_nodes)
<a name="l00455"></a>00455             {
<a name="l00456"></a>00456                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a4b9d0e919091af458ec33afa19b8e2f7">DeselectAllNodes</a>();
<a name="l00457"></a>00457             }
<a name="l00458"></a>00458             <span class="keywordflow">if</span> (node_to_set_selected != <span class="keyword">nullptr</span>)
<a name="l00459"></a>00459             {
<a name="l00460"></a>00460                 node_to_set_selected-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_node.html#ae6d7d38ab11beec2a6316b50d4cb0339">SetSelected</a>(<span class="keyword">true</span>);
<a name="l00461"></a>00461             }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463             <span class="comment">// ==== Query updated data ====</span>
<a name="l00464"></a>00464 
<a name="l00465"></a>00465             <span class="comment">// Update &quot;nodes&quot; panel</span>
<a name="l00466"></a>00466             <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_nodes_data.html">RigAggregateNodesData</a> query;
<a name="l00467"></a>00467             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a2afce2c7c3d30813cbc2e50bd56e8cad">QuerySelectedNodesData</a>(&amp;query);
<a name="l00468"></a>00468 
<a name="l00469"></a>00469             <span class="keywordflow">if</span> (query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_nodes_data.html#a599e95449f74af46370b7ea815338d1d">num_selected</a> != 0)
<a name="l00470"></a>00470             {
<a name="l00471"></a>00471                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3ed0196a93a820038f9258ff7a622176">m_nodes_panel</a>-&gt;UpdateNodeData(&amp;query);
<a name="l00472"></a>00472                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3ed0196a93a820038f9258ff7a622176">m_nodes_panel</a>-&gt;Show();
<a name="l00473"></a>00473             }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475             <span class="comment">// Update BEAM panels</span>
<a name="l00476"></a>00476             <span class="keywordflow">if</span> (query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_nodes_data.html#a599e95449f74af46370b7ea815338d1d">num_selected</a> &gt;= 2)
<a name="l00477"></a>00477             {
<a name="l00478"></a>00478                 <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html">RigAggregateBeams2Data</a> beam_query;
<a name="l00479"></a>00479                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a764684782f54dfeffee4a7c6d112b15b">QuerySelectedBeamsData</a>(&amp;beam_query);
<a name="l00480"></a>00480                 <span class="keywordflow">if</span> (beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#af023a01f3d11820ec1302277aad920b5">GetTotalNumSelectedBeams</a>() != 0)
<a name="l00481"></a>00481                 {
<a name="l00482"></a>00482                     <span class="keywordflow">if</span> (beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a126ffa04729e98ad2e15e29a7c46855f">HasMixedBeamTypes</a>())
<a name="l00483"></a>00483                     {
<a name="l00484"></a>00484                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;UpdateMixedBeamData(&amp;beam_query);
<a name="l00485"></a>00485                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;Show();
<a name="l00486"></a>00486                     }
<a name="l00487"></a>00487                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#abfd9c50b3fc76ed60900f46fbd2a15d3">plain_beams</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_plain_beams_data.html#aa8b2fb0292594479b849e569400e3601">num_selected</a> != 0)
<a name="l00488"></a>00488                     {
<a name="l00489"></a>00489                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;UpdatePlainBeamData(&amp;beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#abfd9c50b3fc76ed60900f46fbd2a15d3">plain_beams</a>);
<a name="l00490"></a>00490                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>-&gt;Show();
<a name="l00491"></a>00491                     }
<a name="l00492"></a>00492                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a32bdf04eb7a312dd95de7e27ae9e1006">hydros</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_hydros_data.html#af2b45e6cfa9e137431324e6a8c6a6ed7">num_selected</a> != 0)
<a name="l00493"></a>00493                     {
<a name="l00494"></a>00494                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5c72131f5585feb3b96a28e7a24322e0">m_hydros_panel</a>-&gt;UpdateHydrosData(&amp;beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a32bdf04eb7a312dd95de7e27ae9e1006">hydros</a>);
<a name="l00495"></a>00495                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5c72131f5585feb3b96a28e7a24322e0">m_hydros_panel</a>-&gt;Show();
<a name="l00496"></a>00496                     }
<a name="l00497"></a>00497                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a2e3fb084f3dd4cf4e1153082379eb1a9">commands2</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_commands2_data.html#a23b4de808c7ce27a0507cc6256829d7f">num_selected</a> != 0)
<a name="l00498"></a>00498                     {
<a name="l00499"></a>00499                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af93ee5801a690e1e5fcacbda4d4e9402">m_commands2_panel</a>-&gt;UpdateCommand2Data(&amp;beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a2e3fb084f3dd4cf4e1153082379eb1a9">commands2</a>);
<a name="l00500"></a>00500                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af93ee5801a690e1e5fcacbda4d4e9402">m_commands2_panel</a>-&gt;Show();
<a name="l00501"></a>00501                     }
<a name="l00502"></a>00502                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a9487b828bba0c3d6efbc14f2535ac433">shocks</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_shocks_data.html#a351cc4d0d4462d92caa7759f1364182e">num_selected</a> != 0)
<a name="l00503"></a>00503                     {
<a name="l00504"></a>00504                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5d7f13c7fda0e660cae9724f8fa6cf5f">m_shocks_panel</a>-&gt;UpdateShockData(&amp;beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a9487b828bba0c3d6efbc14f2535ac433">shocks</a>);
<a name="l00505"></a>00505                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5d7f13c7fda0e660cae9724f8fa6cf5f">m_shocks_panel</a>-&gt;Show();
<a name="l00506"></a>00506                     }
<a name="l00507"></a>00507                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a005c6fa3053e3b3021ac6db9eeec6ff4">shocks2</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_shocks2_data.html#ace9c8b1b80bad44caac515ea8e41760b">num_selected</a> != 0)
<a name="l00508"></a>00508                     {
<a name="l00509"></a>00509                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad71ab5304e4c5022a7331c29c6dac8cf">m_shocks2_panel</a>-&gt;UpdateShock2Data(&amp;beam_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_beams2_data.html#a005c6fa3053e3b3021ac6db9eeec6ff4">shocks2</a>);
<a name="l00510"></a>00510                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad71ab5304e4c5022a7331c29c6dac8cf">m_shocks2_panel</a>-&gt;Show();
<a name="l00511"></a>00511                     }
<a name="l00512"></a>00512                 }
<a name="l00513"></a>00513             } <span class="comment">// if (query.num_selected &gt;= 2)</span>
<a name="l00514"></a>00514         } <span class="comment">// if (node_selection_changed)</span>
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         <span class="keywordtype">bool</span> must_refresh_wheels_mesh = <span class="keyword">false</span>;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a37a5a7b812334c059035ac28007e806c">IsAnyWheelSelectionChangeScheduled</a>())
<a name="l00519"></a>00519         {
<a name="l00520"></a>00520             <span class="comment">// Apply changes from panels</span>
<a name="l00521"></a>00521             <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html">AllWheelsAggregateData</a> wheel_update;
<a name="l00522"></a>00522             wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af6edd4589d6a554c6b00016039679d51">flexbodywheels_data</a> = *<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>-&gt;GetFlexBodyWheelsData();
<a name="l00523"></a>00523             wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af51d531f47312da5de2ca1792edd4247">num_elements</a> += wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af6edd4589d6a554c6b00016039679d51">flexbodywheels_data</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_base_wheel_aggregate_data.html#aebc376cd316e3a456ee97c03b9ce2c47">num_elements</a>;
<a name="l00524"></a>00524             wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#ad1b959562a7c64a543ce16415b63579a">meshwheels2_data</a> = *<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>-&gt;GetMeshWheel2Data();
<a name="l00525"></a>00525             wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af51d531f47312da5de2ca1792edd4247">num_elements</a> += wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#ad1b959562a7c64a543ce16415b63579a">meshwheels2_data</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_base_wheel_aggregate_data.html#aebc376cd316e3a456ee97c03b9ce2c47">num_elements</a>;
<a name="l00526"></a>00526             must_refresh_wheels_mesh = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ad6ebc92d71c52c4ff6a16efb86ab1ead">UpdateSelectedWheelsData</a>(&amp;wheel_update);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528             <span class="comment">// Update selection</span>
<a name="l00529"></a>00529             <span class="keyword">const</span> <span class="keywordtype">bool</span> any_change = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a1d47d5b91e1af7e22169528698bcf7b1">PerformScheduledWheelSelectionUpdates</a>(<span class="keyword">this</span>);
<a name="l00530"></a>00530             this-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4b4765cd43695180e69c6cd32cbcd3bf">ResetAllScheduledWheelSelectionChanges</a>();
<a name="l00531"></a>00531 
<a name="l00532"></a>00532             <span class="keywordflow">if</span> (any_change)
<a name="l00533"></a>00533             {
<a name="l00534"></a>00534                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab4ac10ccc82b0ac47abeee00ababe8aa">HideAllWheelGuiPanels</a>();
<a name="l00535"></a>00535             
<a name="l00536"></a>00536                 <span class="comment">// Query selected wheels data</span>
<a name="l00537"></a>00537                 <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html">AllWheelsAggregateData</a> wheel_query;
<a name="l00538"></a>00538                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a457cd9afc5eb7e58d966e8bc5a67660c">QuerySelectedWheelsData</a>(&amp;wheel_query);
<a name="l00539"></a>00539                 <span class="keywordflow">if</span> (wheel_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af51d531f47312da5de2ca1792edd4247">num_elements</a> != 0)
<a name="l00540"></a>00540                 {
<a name="l00541"></a>00541                     <span class="keywordflow">if</span>(wheel_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#a0c154e51b902a5fa02d64fe99fb55163">ContainsMultipleWheelTypes</a>())
<a name="l00542"></a>00542                     {
<a name="l00543"></a>00543                         <span class="comment">// To be done.</span>
<a name="l00544"></a>00544                     }
<a name="l00545"></a>00545                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wheel_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#ad1b959562a7c64a543ce16415b63579a">meshwheels2_data</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_base_wheel_aggregate_data.html#aebc376cd316e3a456ee97c03b9ce2c47">num_elements</a> != 0)
<a name="l00546"></a>00546                     {
<a name="l00547"></a>00547                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>-&gt;UpdateMeshWheels2Data(&amp;wheel_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#ad1b959562a7c64a543ce16415b63579a">meshwheels2_data</a>);
<a name="l00548"></a>00548                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>-&gt;Show();
<a name="l00549"></a>00549                     }
<a name="l00550"></a>00550                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wheel_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af6edd4589d6a554c6b00016039679d51">flexbodywheels_data</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_base_wheel_aggregate_data.html#aebc376cd316e3a456ee97c03b9ce2c47">num_elements</a> != 0)
<a name="l00551"></a>00551                     {
<a name="l00552"></a>00552                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>-&gt;UpdateFlexBodyWheelsData(&amp;wheel_query.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af6edd4589d6a554c6b00016039679d51">flexbodywheels_data</a>);
<a name="l00553"></a>00553                         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>-&gt;Show();
<a name="l00554"></a>00554                     }
<a name="l00555"></a>00555                 }
<a name="l00556"></a>00556             }
<a name="l00557"></a>00557         }
<a name="l00558"></a>00558         <span class="keywordflow">else</span>
<a name="l00559"></a>00559         {
<a name="l00560"></a>00560             <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html">AllWheelsAggregateData</a> wheel_update;
<a name="l00561"></a>00561             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>-&gt;IsImmediateRigUpdateNeeded())
<a name="l00562"></a>00562             {
<a name="l00563"></a>00563                 wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af6edd4589d6a554c6b00016039679d51">flexbodywheels_data</a> = *<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>-&gt;GetFlexBodyWheelsData();
<a name="l00564"></a>00564                 wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af51d531f47312da5de2ca1792edd4247">num_elements</a> += wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af6edd4589d6a554c6b00016039679d51">flexbodywheels_data</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_base_wheel_aggregate_data.html#aebc376cd316e3a456ee97c03b9ce2c47">num_elements</a>;
<a name="l00565"></a>00565                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>-&gt;SetIsImmediateRigUpdateNeeded(<span class="keyword">false</span>);
<a name="l00566"></a>00566             }
<a name="l00567"></a>00567             <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>-&gt;IsImmediateRigUpdateNeeded())
<a name="l00568"></a>00568             {
<a name="l00569"></a>00569                 wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#ad1b959562a7c64a543ce16415b63579a">meshwheels2_data</a> = *<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>-&gt;GetMeshWheel2Data();
<a name="l00570"></a>00570                 wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af51d531f47312da5de2ca1792edd4247">num_elements</a> += wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#ad1b959562a7c64a543ce16415b63579a">meshwheels2_data</a>.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_base_wheel_aggregate_data.html#aebc376cd316e3a456ee97c03b9ce2c47">num_elements</a>;
<a name="l00571"></a>00571                 <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>-&gt;SetIsImmediateRigUpdateNeeded(<span class="keyword">false</span>);
<a name="l00572"></a>00572             }
<a name="l00573"></a>00573             <span class="keywordflow">if</span> (wheel_update.<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_all_wheels_aggregate_data.html#af51d531f47312da5de2ca1792edd4247">num_elements</a> != 0)
<a name="l00574"></a>00574             {
<a name="l00575"></a>00575                 must_refresh_wheels_mesh = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ad6ebc92d71c52c4ff6a16efb86ab1ead">UpdateSelectedWheelsData</a>(&amp;wheel_update);
<a name="l00576"></a>00576             }
<a name="l00577"></a>00577         }
<a name="l00578"></a>00578 
<a name="l00579"></a>00579         <span class="comment">// ==== Update visuals ====</span>
<a name="l00580"></a>00580         Ogre::SceneNode* parent_scene_node = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;getRootSceneNode();
<a name="l00581"></a>00581         <span class="keywordflow">if</span> (rig_updated || node_selection_changed || node_hover_changed)
<a name="l00582"></a>00582         {
<a name="l00583"></a>00583             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a717b168d21a24ac0338f2c6ae60c881b">RefreshNodesDynamicMeshes</a>(parent_scene_node);
<a name="l00584"></a>00584         }
<a name="l00585"></a>00585         <span class="keywordflow">if</span> (rig_updated)
<a name="l00586"></a>00586         {
<a name="l00587"></a>00587             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a13ddf0660af7c1c101915c9b1efd2c90">RefreshBeamsDynamicMesh</a>();
<a name="l00588"></a>00588         }
<a name="l00589"></a>00589         <span class="keywordtype">bool</span> force_refresh_wheel_selection_boxes = <span class="keyword">false</span>;
<a name="l00590"></a>00590         <span class="keywordflow">if</span> (must_refresh_wheels_mesh)
<a name="l00591"></a>00591         {
<a name="l00592"></a>00592             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a9904d075eeeab637755b079ea9d30db7">RefreshWheelsDynamicMesh</a>(parent_scene_node, <span class="keyword">this</span>);
<a name="l00593"></a>00593             force_refresh_wheel_selection_boxes = <span class="keyword">true</span>;
<a name="l00594"></a>00594         }
<a name="l00595"></a>00595         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a2a944bb64fe15179dc218914bc5abef1">CheckAndRefreshWheelsSelectionHighlights</a>(<span class="keyword">this</span>, parent_scene_node, force_refresh_wheel_selection_boxes);
<a name="l00596"></a>00596         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#aecae0143bac540bfc1379f79a0cc6157">CheckAndRefreshWheelsMouseHoverHighlights</a>(<span class="keyword">this</span>, parent_scene_node);
<a name="l00597"></a>00597     }
<a name="l00598"></a>00598 
<a name="l00599"></a>00599     <span class="comment">/* Update devel console */</span>
<a name="l00600"></a>00600     std::stringstream msg;
<a name="l00601"></a>00601     msg &lt;&lt; <span class="stringliteral">&quot;Camera pos: [X &quot;</span>&lt;&lt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;getPosition().x &lt;&lt;<span class="stringliteral">&quot;, Y &quot;</span>&lt;&lt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;getPosition().y &lt;&lt; <span class="stringliteral">&quot;, Z &quot;</span>&lt;&lt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a983cfc001ddd2af7a3dbd8901712e47e">m_camera</a>-&gt;getPosition().z &lt;&lt;<span class="stringliteral">&quot;] &quot;</span>&lt;&lt;std::endl;
<a name="l00602"></a>00602     msg &lt;&lt; <span class="stringliteral">&quot;Mouse node: &quot;</span>;
<a name="l00603"></a>00603     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#aec363f09d649f122493c7f93558076e1">GetMouseHoveredNode</a>() != <span class="keyword">nullptr</span>)
<a name="l00604"></a>00604     {
<a name="l00605"></a>00605         msg &lt;&lt; <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#aec363f09d649f122493c7f93558076e1">GetMouseHoveredNode</a>()-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_node.html#adb587612f3aa4d4ca876befeca52ec13">GetId</a>().<a class="code" href="class_rig_def_1_1_node_1_1_id.html#a2e84af09c5b954252ed2af4a4bcfdeeb">ToString</a>() &lt;&lt; std::endl;
<a name="l00606"></a>00606     }
<a name="l00607"></a>00607     <span class="keywordflow">else</span>
<a name="l00608"></a>00608     {
<a name="l00609"></a>00609         msg &lt;&lt; <span class="stringliteral">&quot;[null]&quot;</span>&lt;&lt; std::endl;
<a name="l00610"></a>00610     }
<a name="l00611"></a>00611     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#adf7388b0c4242dd9d3d2a9e728fa9ee6">m_debug_box</a>-&gt;setCaption(msg.str());
<a name="l00612"></a>00612 }
<a name="l00613"></a>00613 
<a name="l00614"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4f73e9dc5632524ca803864460b82bb5">00614</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4f73e9dc5632524ca803864460b82bb5">Main::CommandShowDialogOpenRigFile</a>()
<a name="l00615"></a>00615 {
<a name="l00616"></a>00616     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;setDialogInfo(MyGUI::UString(<span class="stringliteral">&quot;Open rig file&quot;</span>), MyGUI::UString(<span class="stringliteral">&quot;Open&quot;</span>), <span class="keyword">false</span>);
<a name="l00617"></a>00617     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;eventEndDialog = MyGUI::newDelegate(<span class="keyword">this</span>, &amp;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a35a10d6c23920802442d32fab1a8d470">Main::NotifyFileSelectorEnded</a>);
<a name="l00618"></a>00618     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;setMode(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_main_1_1_open_save_file_dialog_mode.html#a23b5d1a13f776df710ed206eaba14372">OpenSaveFileDialogMode::MODE_OPEN_TRUCK</a>);
<a name="l00619"></a>00619     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;doModal(); <span class="comment">// Shows the dialog</span>
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#acb4af1361d9233f5ee2fa658536a7658">00622</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#acb4af1361d9233f5ee2fa658536a7658">Main::CommandShowDialogSaveRigFileAs</a>()
<a name="l00623"></a>00623 {
<a name="l00624"></a>00624     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l00625"></a>00625     {
<a name="l00626"></a>00626         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;setDialogInfo(MyGUI::UString(<span class="stringliteral">&quot;Save rig file&quot;</span>), MyGUI::UString(<span class="stringliteral">&quot;Save&quot;</span>), <span class="keyword">false</span>);
<a name="l00627"></a>00627         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;eventEndDialog = MyGUI::newDelegate(<span class="keyword">this</span>, &amp;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a35a10d6c23920802442d32fab1a8d470">Main::NotifyFileSelectorEnded</a>);
<a name="l00628"></a>00628         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;setMode(<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_main_1_1_open_save_file_dialog_mode.html#a660a071847aea391bf8a2d2ea841af8f">OpenSaveFileDialogMode::MODE_SAVE_TRUCK_AS</a>);
<a name="l00629"></a>00629         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;doModal(); <span class="comment">// Shows the dialog</span>
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631 }
<a name="l00632"></a>00632 
<a name="l00633"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a331b5ebddaf53b67a62917ffe0fbfe31">00633</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a331b5ebddaf53b67a62917ffe0fbfe31">Main::CommandSaveRigFile</a>()
<a name="l00634"></a>00634 {
<a name="l00635"></a>00635     <span class="comment">// TODO</span>
<a name="l00636"></a>00636 }
<a name="l00637"></a>00637 
<a name="l00638"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a00aa0d6827d460587e6ebf2b84bca9a8">00638</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a00aa0d6827d460587e6ebf2b84bca9a8">Main::CommandCloseCurrentRig</a>()
<a name="l00639"></a>00639 {
<a name="l00640"></a>00640     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l00641"></a>00641     {
<a name="l00642"></a>00642         <span class="comment">// Remove rig</span>
<a name="l00643"></a>00643         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a0c8298efe94e90610d03cfb403614701">DetachFromScene</a>();
<a name="l00644"></a>00644         <span class="keyword">delete</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>;
<a name="l00645"></a>00645         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> = <span class="keyword">nullptr</span>;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647         <span class="comment">// Restore GUI</span>
<a name="l00648"></a>00648         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4e9ceeb031f661d90ee6220ffc994377">HideAllNodeBeamGuiPanels</a>();
<a name="l00649"></a>00649         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a>-&gt;ClearLandVehicleWheelsList();
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651 }
<a name="l00652"></a>00652 
<a name="l00653"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a35a10d6c23920802442d32fab1a8d470">00653</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a35a10d6c23920802442d32fab1a8d470">Main::NotifyFileSelectorEnded</a>(<a class="code" href="class_ro_r_1_1_g_u_i_1_1_dialog.html">GUI::Dialog</a>* dialog, <span class="keywordtype">bool</span> result)
<a name="l00654"></a>00654 {
<a name="l00655"></a>00655     <span class="keywordflow">if</span> (result)
<a name="l00656"></a>00656     {
<a name="l00657"></a>00657         <span class="keyword">const</span> MyGUI::UString &amp; mode = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;getMode();
<a name="l00658"></a>00658         <span class="keyword">auto</span> <span class="keyword">const</span> &amp; folder = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;getCurrentFolder();
<a name="l00659"></a>00659         <span class="keyword">auto</span> <span class="keyword">const</span> &amp; filename = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>-&gt;getFileName();
<a name="l00660"></a>00660 
<a name="l00661"></a>00661         <span class="keywordflow">if</span> (mode == <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_main_1_1_open_save_file_dialog_mode.html#a23b5d1a13f776df710ed206eaba14372">OpenSaveFileDialogMode::MODE_OPEN_TRUCK</a>)
<a name="l00662"></a>00662         {
<a name="l00663"></a>00663             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a0ae39993d636eacc5dfe567c5f5ac4b9">LoadRigDefFile</a>(folder, filename);
<a name="l00664"></a>00664         }
<a name="l00665"></a>00665         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mode == <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_main_1_1_open_save_file_dialog_mode.html#a660a071847aea391bf8a2d2ea841af8f">OpenSaveFileDialogMode::MODE_SAVE_TRUCK_AS</a>)
<a name="l00666"></a>00666         {
<a name="l00667"></a>00667             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9e367d1e6cc15d9481e2cf07e178b074">SaveRigDefFile</a>(folder, filename);
<a name="l00668"></a>00668         }
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670     dialog-&gt;<a class="code" href="class_ro_r_1_1_g_u_i_1_1_dialog.html#a883b9e564532d0c1613048b569f2b9a4">endModal</a>(); <span class="comment">// Hides the dialog</span>
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00673"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9e367d1e6cc15d9481e2cf07e178b074">00673</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9e367d1e6cc15d9481e2cf07e178b074">Main::SaveRigDefFile</a>(MyGUI::UString <span class="keyword">const</span> &amp; directory, MyGUI::UString <span class="keyword">const</span> &amp; filename)
<a name="l00674"></a>00674 {
<a name="l00675"></a>00675     <span class="keyword">using namespace </span>RigDef;
<a name="l00676"></a>00676 
<a name="l00677"></a>00677     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> == <span class="keyword">nullptr</span>)
<a name="l00678"></a>00678     {
<a name="l00679"></a>00679         <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(<span class="stringliteral">&quot;RigEditor: [WARNING] SaveRigDefFile(): Nothing to save.&quot;</span>);
<a name="l00680"></a>00680         <span class="keywordflow">return</span>;
<a name="l00681"></a>00681     }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683     <span class="keyword">auto</span> rig_def = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a9b39d0f6395071ab174634f431c30a6f">Export</a>();
<a name="l00684"></a>00684     <span class="keyword">auto</span> out_path = directory + <span class="charliteral">&#39;/&#39;</span> + filename;
<a name="l00685"></a>00685     <a class="code" href="class_rig_def_1_1_serializer.html" title="Serializes the RigDef::File data structure to file.">Serializer</a> serializer(rig_def, out_path);
<a name="l00686"></a>00686     serializer.<a class="code" href="class_rig_def_1_1_serializer.html#a0d25ba7124bac77109b3251d0d5014ec">Serialize</a>();
<a name="l00687"></a>00687     <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(<span class="stringliteral">&quot;RigEditor: Rig saved as: &quot;</span> + out_path);
<a name="l00688"></a>00688 }
<a name="l00689"></a>00689 
<a name="l00690"></a><a class="code" href="_rig_editor___main_8cpp.html#a2e14b7ecf0742dc7430810be2fd498ad">00690</a> <span class="keywordtype">void</span> <a class="code" href="_rig_editor___main_8cpp.html#a2e14b7ecf0742dc7430810be2fd498ad">RigEditor_LogParserMessages</a>(<a class="code" href="class_rig_def_1_1_parser.html" title="Checks the rig-def file syntax and pulls data to File object.">RigDef::Parser</a> &amp; parser)
<a name="l00691"></a>00691 {
<a name="l00692"></a>00692     <span class="keywordflow">if</span> (parser.<a class="code" href="class_rig_def_1_1_parser.html#a562b4cb4baf62a5c201c6755bc41558f">GetMessages</a>().size() == 0)
<a name="l00693"></a>00693     {
<a name="l00694"></a>00694         <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(<span class="stringliteral">&quot;RigEditor: Parsing done OK&quot;</span>);
<a name="l00695"></a>00695         <span class="keywordflow">return</span>;
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698     std::stringstream report;
<a name="l00699"></a>00699     report &lt;&lt; <span class="stringliteral">&quot;RigEditor: Parsing done, report:&quot;</span> &lt;&lt; std::endl &lt;&lt;std::endl;
<a name="l00700"></a>00700 
<a name="l00701"></a>00701     <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter = parser.<a class="code" href="class_rig_def_1_1_parser.html#a562b4cb4baf62a5c201c6755bc41558f">GetMessages</a>().begin(); iter != parser.<a class="code" href="class_rig_def_1_1_parser.html#a562b4cb4baf62a5c201c6755bc41558f">GetMessages</a>().end(); iter++)
<a name="l00702"></a>00702     {
<a name="l00703"></a>00703         <span class="keywordflow">switch</span> (iter-&gt;type)
<a name="l00704"></a>00704         {
<a name="l00705"></a>00705             <span class="keywordflow">case</span> (<a class="code" href="struct_rig_def_1_1_parser_1_1_message.html#a3c1de745c4fe47bb608fdd890c6852b4a4c922b155c371ce84feb0039d875ce19">RigDef::Parser::Message::TYPE_FATAL_ERROR</a>): 
<a name="l00706"></a>00706                 report &lt;&lt; <span class="stringliteral">&quot;FATAL_ERROR&quot;</span>; 
<a name="l00707"></a>00707                 <span class="keywordflow">break</span>;
<a name="l00708"></a>00708 
<a name="l00709"></a>00709             <span class="keywordflow">case</span> (<a class="code" href="struct_rig_def_1_1_parser_1_1_message.html#a3c1de745c4fe47bb608fdd890c6852b4aa1163c91029a2aa93afc5caff9a43122">RigDef::Parser::Message::TYPE_ERROR</a>): 
<a name="l00710"></a>00710                 report &lt;&lt; <span class="stringliteral">&quot;ERROR&quot;</span>; 
<a name="l00711"></a>00711                 <span class="keywordflow">break</span>;
<a name="l00712"></a>00712 
<a name="l00713"></a>00713             <span class="keywordflow">case</span> (<a class="code" href="struct_rig_def_1_1_parser_1_1_message.html#a3c1de745c4fe47bb608fdd890c6852b4af141ae5bfdab8d49af203eefb1ce5927">RigDef::Parser::Message::TYPE_WARNING</a>): 
<a name="l00714"></a>00714                 report &lt;&lt; <span class="stringliteral">&quot;WARNING&quot;</span>; 
<a name="l00715"></a>00715                 <span class="keywordflow">break</span>;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717             <span class="keywordflow">default</span>:
<a name="l00718"></a>00718                 report &lt;&lt; <span class="stringliteral">&quot;INFO&quot;</span>; 
<a name="l00719"></a>00719                 <span class="keywordflow">break</span>;
<a name="l00720"></a>00720         }
<a name="l00721"></a>00721         report &lt;&lt; <span class="stringliteral">&quot; (Section &quot;</span> &lt;&lt; <a class="code" href="struct_rig_def_1_1_file.html#a9df66ca1a72485fbce67ef8d2b0395da">RigDef::File::SectionToString</a>(iter-&gt;section) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;
<a name="l00722"></a>00722         report &lt;&lt; <span class="stringliteral">&quot;\tLine (# &quot;</span> &lt;&lt; iter-&gt;line_number &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; iter-&gt;line &lt;&lt; std::endl;
<a name="l00723"></a>00723         report &lt;&lt; <span class="stringliteral">&quot;\tMessage: &quot;</span> &lt;&lt; iter-&gt;message &lt;&lt; std::endl;
<a name="l00724"></a>00724     }
<a name="l00725"></a>00725 
<a name="l00726"></a>00726     Ogre::LogManager::getSingleton().logMessage(report.str());
<a name="l00727"></a>00727 }
<a name="l00728"></a>00728 
<a name="l00729"></a><a class="code" href="_rig_editor___main_8cpp.html#a3cf86e68db66eadf020fd91edc190d34">00729</a> <span class="keywordtype">void</span> <a class="code" href="_rig_editor___main_8cpp.html#a3cf86e68db66eadf020fd91edc190d34">RigEditor_LogValidatorMessages</a>(<a class="code" href="class_rig_def_1_1_validator.html">RigDef::Validator</a> &amp; validator)
<a name="l00730"></a>00730 {
<a name="l00731"></a>00731     <span class="keywordflow">if</span> (validator.<a class="code" href="class_rig_def_1_1_validator.html#a58d237581d2aa282aef507d5613ac3d0">GetMessages</a>().empty())
<a name="l00732"></a>00732     {
<a name="l00733"></a>00733         Ogre::LogManager::getSingleton().logMessage(<span class="stringliteral">&quot;RigEditor: Validating done OK&quot;</span>);
<a name="l00734"></a>00734         <span class="keywordflow">return</span>;
<a name="l00735"></a>00735     }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737     std::ostringstream report;
<a name="l00738"></a>00738     report &lt;&lt; <span class="stringliteral">&quot;RigEditor: Validating done, report:&quot;</span> &lt;&lt;std::endl &lt;&lt; std::endl;
<a name="l00739"></a>00739 
<a name="l00740"></a>00740     <span class="keywordflow">for</span>(<span class="keyword">auto</span> itor = validator.<a class="code" href="class_rig_def_1_1_validator.html#a58d237581d2aa282aef507d5613ac3d0">GetMessages</a>().begin(); itor != validator.<a class="code" href="class_rig_def_1_1_validator.html#a58d237581d2aa282aef507d5613ac3d0">GetMessages</a>().end(); itor++)
<a name="l00741"></a>00741     {
<a name="l00742"></a>00742         <span class="keywordflow">switch</span> (itor-&gt;type)
<a name="l00743"></a>00743         {
<a name="l00744"></a>00744             <span class="keywordflow">case</span> (<a class="code" href="struct_rig_def_1_1_validator_1_1_message.html#a105973af851ab0bc62e860e1938b8771adc14aca9844d145d817c30f7609139e4">RigDef::Validator::Message::TYPE_FATAL_ERROR</a>):
<a name="l00745"></a>00745                 report &lt;&lt; <span class="stringliteral">&quot;FATAL ERROR&quot;</span>;
<a name="l00746"></a>00746                 <span class="keywordflow">break</span>;
<a name="l00747"></a>00747             <span class="keywordflow">case</span> (<a class="code" href="struct_rig_def_1_1_validator_1_1_message.html#a105973af851ab0bc62e860e1938b8771a803b7bb484f8f1eca4c1f2bfe3e142d4">RigDef::Validator::Message::TYPE_ERROR</a>):
<a name="l00748"></a>00748                 report &lt;&lt; <span class="stringliteral">&quot;ERROR&quot;</span>;
<a name="l00749"></a>00749                 <span class="keywordflow">break</span>;
<a name="l00750"></a>00750             <span class="keywordflow">case</span> (<a class="code" href="struct_rig_def_1_1_validator_1_1_message.html#a105973af851ab0bc62e860e1938b8771a46bc0cfaa0a5bee3093395e8cbe01a77">RigDef::Validator::Message::TYPE_WARNING</a>):
<a name="l00751"></a>00751                 report &lt;&lt; <span class="stringliteral">&quot;WARNING&quot;</span>;
<a name="l00752"></a>00752                 <span class="keywordflow">break</span>;
<a name="l00753"></a>00753             <span class="keywordflow">default</span>:
<a name="l00754"></a>00754                 report &lt;&lt; <span class="stringliteral">&quot;INFO&quot;</span>;
<a name="l00755"></a>00755         }
<a name="l00756"></a>00756 
<a name="l00757"></a>00757         report &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; itor-&gt;text &lt;&lt; std::endl;
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760     Ogre::LogManager::getSingleton().logMessage(report.str());
<a name="l00761"></a>00761 }
<a name="l00762"></a>00762 
<a name="l00763"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a0ae39993d636eacc5dfe567c5f5ac4b9">00763</a> <span class="keywordtype">bool</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a0ae39993d636eacc5dfe567c5f5ac4b9">Main::LoadRigDefFile</a>(MyGUI::UString <span class="keyword">const</span> &amp; directory, MyGUI::UString <span class="keyword">const</span> &amp; filename)
<a name="l00764"></a>00764 {
<a name="l00765"></a>00765     <span class="comment">/* CLOSE PREVIOUS RIG */</span>
<a name="l00766"></a>00766 
<a name="l00767"></a>00767     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l00768"></a>00768     {
<a name="l00769"></a>00769         this-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a00aa0d6827d460587e6ebf2b84bca9a8">CommandCloseCurrentRig</a>();
<a name="l00770"></a>00770     }
<a name="l00771"></a>00771 
<a name="l00772"></a>00772     <span class="comment">/* LOAD */</span>
<a name="l00773"></a>00773 
<a name="l00774"></a>00774     Ogre::DataStreamPtr stream = Ogre::DataStreamPtr();
<a name="l00775"></a>00775     Ogre::String resource_group_name(<span class="stringliteral">&quot;RigEditor_CurrentProject&quot;</span>);
<a name="l00776"></a>00776 
<a name="l00777"></a>00777     <span class="keywordflow">try</span>
<a name="l00778"></a>00778     {
<a name="l00779"></a>00779         Ogre::ResourceGroupManager::getSingleton().addResourceLocation(directory, <span class="stringliteral">&quot;FileSystem&quot;</span>, resource_group_name);
<a name="l00780"></a>00780         stream = Ogre::ResourceGroupManager::getSingleton().openResource(filename, resource_group_name);
<a name="l00781"></a>00781     } 
<a name="l00782"></a>00782     <span class="keywordflow">catch</span> (Ogre::Exception&amp; e)
<a name="l00783"></a>00783     {
<a name="l00784"></a>00784         <span class="comment">// TODO: Report error to user</span>
<a name="l00785"></a>00785 
<a name="l00786"></a>00786         <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(<span class="stringliteral">&quot;RigEditor: Failed to retrieve rig file&quot;</span> + filename + <span class="stringliteral">&quot;, Ogre::Exception was thrown with message: &quot;</span> + e.what());
<a name="l00787"></a>00787         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00788"></a>00788     }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790     <span class="comment">/* PARSE */</span>
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(<span class="stringliteral">&quot;RigEditor: Parsing rig file: &quot;</span> + filename);
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     <a class="code" href="class_rig_def_1_1_parser.html" title="Checks the rig-def file syntax and pulls data to File object.">RigDef::Parser</a> parser;
<a name="l00795"></a>00795     parser.<a class="code" href="class_rig_def_1_1_parser.html#a305ad5ffe72cfa30ee4bf98907f58cda">Prepare</a>();
<a name="l00796"></a>00796     <span class="keywordflow">while</span>(! stream-&gt;eof())
<a name="l00797"></a>00797     {
<a name="l00798"></a>00798         parser.<a class="code" href="class_rig_def_1_1_parser.html#a572673469cf88cdebbd30e04df5629ff">ParseLine</a>(stream-&gt;getLine());
<a name="l00799"></a>00799     }
<a name="l00800"></a>00800     parser.<a class="code" href="class_rig_def_1_1_parser.html#a9a7080ad3fe8eba6d5879028b22c5c2c">Finalize</a>();
<a name="l00801"></a>00801 
<a name="l00802"></a>00802     <a class="code" href="_rig_editor___main_8cpp.html#a2e14b7ecf0742dc7430810be2fd498ad">RigEditor_LogParserMessages</a>(parser);
<a name="l00803"></a>00803 
<a name="l00804"></a>00804     <span class="comment">/* VALIDATE */</span>
<a name="l00805"></a>00805 
<a name="l00806"></a>00806     <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(<span class="stringliteral">&quot;RigEditor: Validating vehicle: &quot;</span> + parser.<a class="code" href="class_rig_def_1_1_parser.html#a0aecd9496870d4a0dabb7652de4c020b">GetFile</a>()-&gt;name);
<a name="l00807"></a>00807 
<a name="l00808"></a>00808     <a class="code" href="class_rig_def_1_1_validator.html">RigDef::Validator</a> validator;
<a name="l00809"></a>00809     validator.<a class="code" href="class_rig_def_1_1_validator.html#a183280e3ae4d3532da079b78bba7b489">Setup</a>(parser.<a class="code" href="class_rig_def_1_1_parser.html#a0aecd9496870d4a0dabb7652de4c020b">GetFile</a>());
<a name="l00810"></a>00810     <span class="keywordtype">bool</span> valid = validator.Validate();
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     <a class="code" href="_rig_editor___main_8cpp.html#a3cf86e68db66eadf020fd91edc190d34">RigEditor_LogValidatorMessages</a>(validator);
<a name="l00813"></a>00813 
<a name="l00814"></a>00814     <span class="keywordflow">if</span> (! valid)
<a name="l00815"></a>00815     {
<a name="l00816"></a>00816         <span class="comment">// TODO: Report error to user</span>
<a name="l00817"></a>00817 
<a name="l00818"></a>00818         <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(<span class="stringliteral">&quot;RigEditor: Validating failed!&quot;</span>);
<a name="l00819"></a>00819         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00820"></a>00820     }
<a name="l00821"></a>00821 
<a name="l00822"></a>00822     <span class="comment">/* BUILD RIG MESH */</span>
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> = <span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html">RigEditor::Rig</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>);
<a name="l00825"></a>00825     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig_building_report.html">RigEditor::RigBuildingReport</a> rig_build_report;
<a name="l00826"></a>00826     Ogre::SceneNode* parent_scene_node = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;getRootSceneNode();
<a name="l00827"></a>00827     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a313a85e2e173bd3d0ea38e5135f68e1b">Build</a>(parser.<a class="code" href="class_rig_def_1_1_parser.html#a0aecd9496870d4a0dabb7652de4c020b">GetFile</a>(), <span class="keyword">this</span>, parent_scene_node, &amp;rig_build_report);
<a name="l00828"></a>00828 
<a name="l00829"></a>00829     <span class="comment">/* SHOW MESH */</span>
<a name="l00830"></a>00830     this-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7043ad34e928efff290d0b9f2192a613">OnNewRigCreatedOrLoaded</a>(parent_scene_node);
<a name="l00831"></a>00831 
<a name="l00832"></a>00832     <a class="code" href="_ro_r_prerequisites_8h.html#af855c94dc540e943632089ce7496faac">LOG</a>(Ogre::String(<span class="stringliteral">&quot;RigEditor: Finished loading rig, report:\n&quot;</span>) + rig_build_report.<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig_building_report.html#aea1084f0caa0f03a4244932713056941">ToString</a>());
<a name="l00833"></a>00833 
<a name="l00834"></a>00834     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7043ad34e928efff290d0b9f2192a613">00837</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7043ad34e928efff290d0b9f2192a613">Main::OnNewRigCreatedOrLoaded</a>(Ogre::SceneNode* parent_scene_node)
<a name="l00838"></a>00838 {
<a name="l00839"></a>00839     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a27c5ff7f160c89c4eb8bd62734922aa3">AttachToScene</a>(parent_scene_node);
<a name="l00840"></a>00840     <span class="comment">/* Handle mouse selection of nodes */</span>
<a name="l00841"></a>00841     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a0a03055933371812797a04a1353479f1">RefreshAllNodesScreenPositions</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab55221041ec36a518706dcb79f174f3e">m_camera_handler</a>);
<a name="l00842"></a>00842     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a7903b41d8fc63f6d73a4834f19209914">RefreshMouseHoveredNode</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a08c60c6f9adaf40ed4e1ac55231d1f78">m_input_handler</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_input_handler.html#a5bf85347042c691cc2dbb6240f79249c">GetMouseMotionEvent</a>().<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_input_handler_1_1_mouse_motion_event.html#acc2ecfe055276ffcc2c6dd7c59f85bfa">GetAbsolutePosition</a>()))
<a name="l00843"></a>00843     {
<a name="l00844"></a>00844         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a717b168d21a24ac0338f2c6ae60c881b">RefreshNodesDynamicMeshes</a>(parent_scene_node);
<a name="l00845"></a>00845     }
<a name="l00846"></a>00846     <span class="comment">/* Update GUI */</span>
<a name="l00847"></a>00847     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a>-&gt;ClearLandVehicleWheelsList();
<a name="l00848"></a>00848     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a>-&gt;UpdateLandVehicleWheelsList(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ab31018673617622ae5a93340d2cfe1d5">GetWheels</a>());
<a name="l00849"></a>00849 }
<a name="l00850"></a>00850 
<a name="l00851"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1c1f2d324278f4ba5e485881cdb384f1">00851</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1c1f2d324278f4ba5e485881cdb384f1">Main::CommandCurrentRigDeleteSelectedNodes</a>()
<a name="l00852"></a>00852 {
<a name="l00853"></a>00853     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;Hide();
<a name="l00854"></a>00854     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4e9ceeb031f661d90ee6220ffc994377">HideAllNodeBeamGuiPanels</a>();
<a name="l00855"></a>00855     assert(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>);
<a name="l00856"></a>00856     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a202ab00e9660d370f25d6887d6653a70">DeleteSelectedNodes</a>();
<a name="l00857"></a>00857     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a13ddf0660af7c1c101915c9b1efd2c90">RefreshBeamsDynamicMesh</a>();
<a name="l00858"></a>00858     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a717b168d21a24ac0338f2c6ae60c881b">RefreshNodesDynamicMeshes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;getRootSceneNode());
<a name="l00859"></a>00859 }
<a name="l00860"></a>00860 
<a name="l00861"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4e9ceeb031f661d90ee6220ffc994377">00861</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4e9ceeb031f661d90ee6220ffc994377">Main::HideAllNodeBeamGuiPanels</a>()
<a name="l00862"></a>00862 {
<a name="l00863"></a>00863     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3ed0196a93a820038f9258ff7a622176">m_nodes_panel</a>    -&gt;HideAndReset();
<a name="l00864"></a>00864     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>    -&gt;HideAndReset();
<a name="l00865"></a>00865     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5c72131f5585feb3b96a28e7a24322e0">m_hydros_panel</a>   -&gt;HideAndReset();
<a name="l00866"></a>00866     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af93ee5801a690e1e5fcacbda4d4e9402">m_commands2_panel</a>-&gt;HideAndReset();
<a name="l00867"></a>00867     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad71ab5304e4c5022a7331c29c6dac8cf">m_shocks2_panel</a>  -&gt;HideAndReset();
<a name="l00868"></a>00868     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5d7f13c7fda0e660cae9724f8fa6cf5f">m_shocks_panel</a>   -&gt;HideAndReset();
<a name="l00869"></a>00869 }
<a name="l00870"></a>00870 
<a name="l00871"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ae35ae0a10dd9ccbe9f6aa3270d61c2fb">00871</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ae35ae0a10dd9ccbe9f6aa3270d61c2fb">Main::CommandCurrentRigDeleteSelectedBeams</a>()
<a name="l00872"></a>00872 {
<a name="l00873"></a>00873     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>-&gt;Hide();
<a name="l00874"></a>00874     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a4e9ceeb031f661d90ee6220ffc994377">HideAllNodeBeamGuiPanels</a>();
<a name="l00875"></a>00875     assert(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>);
<a name="l00876"></a>00876     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#aa1d9bda9db234aec6f6efb182ba8e4ab">DeleteBeamsBetweenSelectedNodes</a>();
<a name="l00877"></a>00877     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a13ddf0660af7c1c101915c9b1efd2c90">RefreshBeamsDynamicMesh</a>();
<a name="l00878"></a>00878     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a717b168d21a24ac0338f2c6ae60c881b">RefreshNodesDynamicMeshes</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;getRootSceneNode());
<a name="l00879"></a>00879 }
<a name="l00880"></a>00880 
<a name="l00881"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#afa5bf762cf161c9cdb697b1e5242c4bc">00881</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#afa5bf762cf161c9cdb697b1e5242c4bc">Main::CommandQuitRigEditor</a>()
<a name="l00882"></a>00882 {
<a name="l00883"></a>00883     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ae78aa7f3aaffa331367d99488458b8b3">m_exit_loop_requested</a> = <span class="keyword">true</span>;
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 
<a name="l00886"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8794cd1274ff08b674f0735aaf129600">00886</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8794cd1274ff08b674f0735aaf129600">Main::CommandShowRigPropertiesWindow</a>()
<a name="l00887"></a>00887 {
<a name="l00888"></a>00888     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l00889"></a>00889     {
<a name="l00890"></a>00890         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7c1fa6a1a24755bfebf3182d3e384b83">m_gui_rig_properties_window</a>-&gt;Import(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a12ab19624fd013e0cb379ab6b81ec41d">GetProperties</a>());
<a name="l00891"></a>00891         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7c1fa6a1a24755bfebf3182d3e384b83">m_gui_rig_properties_window</a>-&gt;Show();
<a name="l00892"></a>00892         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7c1fa6a1a24755bfebf3182d3e384b83">m_gui_rig_properties_window</a>-&gt;CenterToScreen();
<a name="l00893"></a>00893     }
<a name="l00894"></a>00894 }
<a name="l00895"></a>00895 
<a name="l00896"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a55bcd6dac382f4df61bcc20b25c3811b">00896</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a55bcd6dac382f4df61bcc20b25c3811b">Main::CommandSaveContentOfRigPropertiesWindow</a>()
<a name="l00897"></a>00897 {
<a name="l00898"></a>00898     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7c1fa6a1a24755bfebf3182d3e384b83">m_gui_rig_properties_window</a>-&gt;IsVisible())
<a name="l00899"></a>00899     {
<a name="l00900"></a>00900         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7c1fa6a1a24755bfebf3182d3e384b83">m_gui_rig_properties_window</a>-&gt;Export(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a12ab19624fd013e0cb379ab6b81ec41d">GetProperties</a>());
<a name="l00901"></a>00901     }
<a name="l00902"></a>00902 }
<a name="l00903"></a>00903 
<a name="l00904"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7cc0b6e0fae2e32cc38ff3270f7f6648">00904</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7cc0b6e0fae2e32cc38ff3270f7f6648">Main::CommandShowLandVehiclePropertiesWindow</a>()
<a name="l00905"></a>00905 {
<a name="l00906"></a>00906     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l00907"></a>00907     {
<a name="l00908"></a>00908         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a>-&gt;Import(
<a name="l00909"></a>00909             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a12ab19624fd013e0cb379ab6b81ec41d">GetProperties</a>()-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig_properties.html#a227132ef715f75b9fa8f054e7032131d">GetEngine</a>(),
<a name="l00910"></a>00910             <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a12ab19624fd013e0cb379ab6b81ec41d">GetProperties</a>()-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig_properties.html#a4457c10b93b97171adbccd1cde083e4c">GetEngoption</a>()
<a name="l00911"></a>00911             );
<a name="l00912"></a>00912         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a>-&gt;Show();
<a name="l00913"></a>00913         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a>-&gt;CenterToScreen();     
<a name="l00914"></a>00914     }
<a name="l00915"></a>00915 }
<a name="l00916"></a>00916 
<a name="l00917"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af29e78c09b06d6a4f98ead6abc3d85d2">00917</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af29e78c09b06d6a4f98ead6abc3d85d2">Main::CommandSaveLandVehiclePropertiesWindowData</a>()
<a name="l00918"></a>00918 {
<a name="l00919"></a>00919     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a>-&gt;IsVisible())
<a name="l00920"></a>00920     {
<a name="l00921"></a>00921         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a12ab19624fd013e0cb379ab6b81ec41d">GetProperties</a>()-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig_properties.html#a65015ae8ac759484d26545697b054836">SetEngine</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a>-&gt;ExportEngine());
<a name="l00922"></a>00922         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a12ab19624fd013e0cb379ab6b81ec41d">GetProperties</a>()-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig_properties.html#ab5b535fc62d105f687050a4f043c40ce">SetEngoption</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a>-&gt;ExportEngoption());
<a name="l00923"></a>00923     }
<a name="l00924"></a>00924 }
<a name="l00925"></a>00925 
<a name="l00926"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a2226fe0211c7a8e019f0f2cc5c5f7e82">00926</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a2226fe0211c7a8e019f0f2cc5c5f7e82">Main::CommandShowHelpWindow</a>()
<a name="l00927"></a>00927 {
<a name="l00928"></a>00928     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9b403eaeb6c960ffc6b452bf126b7b24">m_gui_help_window</a>-&gt;Show();
<a name="l00929"></a>00929     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9b403eaeb6c960ffc6b452bf126b7b24">m_gui_help_window</a>-&gt;CenterToScreen();
<a name="l00930"></a>00930 }
<a name="l00931"></a>00931 
<a name="l00932"></a><a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">00932</a> <span class="preprocessor">#define INIT_OR_RESTORE_RIG_ELEMENT_PANEL(VAR, CLASSNAME) \</span>
<a name="l00933"></a>00933 <span class="preprocessor">    if ((VAR).get() == nullptr) \</span>
<a name="l00934"></a>00934 <span class="preprocessor">        (VAR) = std::unique_ptr&lt;GUI::CLASSNAME&gt;(new GUI::CLASSNAME(this, m_config)); \</span>
<a name="l00935"></a>00935 <span class="preprocessor">    else \</span>
<a name="l00936"></a>00936 <span class="preprocessor">        (VAR)-&gt;ShowIfHiddenTemporarily();</span>
<a name="l00937"></a>00937 <span class="preprocessor"></span>
<a name="l00938"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1185efd5764badfe2d8ed84661c7890b">00938</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1185efd5764badfe2d8ed84661c7890b">Main::InitializeOrRestoreGui</a>()
<a name="l00939"></a>00939 {
<a name="l00940"></a>00940     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3ed0196a93a820038f9258ff7a622176">m_nodes_panel</a>,            RigEditorNodePanel);
<a name="l00941"></a>00941     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a695cd4aa09794578eb9695cabfcb8c12">m_beams_panel</a>,            RigEditorBeamsPanel);
<a name="l00942"></a>00942     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5c72131f5585feb3b96a28e7a24322e0">m_hydros_panel</a>,           RigEditorHydrosPanel);
<a name="l00943"></a>00943     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#af93ee5801a690e1e5fcacbda4d4e9402">m_commands2_panel</a>,        RigEditorCommands2Panel);
<a name="l00944"></a>00944     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a5d7f13c7fda0e660cae9724f8fa6cf5f">m_shocks_panel</a>,           RigEditorShocksPanel);
<a name="l00945"></a>00945     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad71ab5304e4c5022a7331c29c6dac8cf">m_shocks2_panel</a>,          RigEditorShocks2Panel);
<a name="l00946"></a>00946     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>,      RigEditorMeshWheels2Panel);
<a name="l00947"></a>00947     <a class="code" href="_rig_editor___main_8cpp.html#a222985d22587fcb772c62ceabe14096c">INIT_OR_RESTORE_RIG_ELEMENT_PANEL</a>( <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>,   RigEditorFlexBodyWheelsPanel);
<a name="l00948"></a>00948 
<a name="l00949"></a>00949     <a class="code" href="class_ro_r_1_1_application.html#a3db1b8c7dc6bf465f5ed653ef4a8ce9a">RoR::Application::GetGuiManager</a>()-&gt;<a class="code" href="class_ro_r_1_1_g_u_i_manager.html#aed1b258a401a3e2dda25bb22494d7f2a">SetSceneManager</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>);
<a name="l00950"></a>00950     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a>.get() == <span class="keyword">nullptr</span>)
<a name="l00951"></a>00951     {
<a name="l00952"></a>00952         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a> = std::unique_ptr&lt;GUI::RigEditorMenubar&gt;(<span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_g_u_i_1_1_rig_editor_menubar.html">GUI::RigEditorMenubar</a>(<span class="keyword">this</span>));
<a name="l00953"></a>00953     }
<a name="l00954"></a>00954     <span class="keywordflow">else</span>
<a name="l00955"></a>00955     {
<a name="l00956"></a>00956         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a>-&gt;Show();
<a name="l00957"></a>00957     }
<a name="l00958"></a>00958     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a3dc9597941137e165efedc7b9e68f78f">m_gui_menubar</a>-&gt;StretchWidthToScreen();
<a name="l00959"></a>00959     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a>.get() == <span class="keyword">nullptr</span>)
<a name="l00960"></a>00960     {
<a name="l00961"></a>00961         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1b0c714feef6aff6885f5638eead4e7a">m_gui_open_save_file_dialog</a> = std::unique_ptr&lt;GUI::OpenSaveFileDialog&gt;(<span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_g_u_i_1_1_open_save_file_dialog.html">GUI::OpenSaveFileDialog</a>());
<a name="l00962"></a>00962     }
<a name="l00963"></a>00963     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a>.get() == <span class="keyword">nullptr</span>)
<a name="l00964"></a>00964     {
<a name="l00965"></a>00965         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9534b1c5593319477e88a0976067054d">m_gui_delete_menu</a> = std::unique_ptr&lt;GUI::RigEditorDeleteMenu&gt;(<span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_g_u_i_1_1_rig_editor_delete_menu.html">GUI::RigEditorDeleteMenu</a>(<span class="keyword">this</span>));
<a name="l00966"></a>00966     }
<a name="l00967"></a>00967     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7c1fa6a1a24755bfebf3182d3e384b83">m_gui_rig_properties_window</a>.get() == <span class="keyword">nullptr</span>)
<a name="l00968"></a>00968     {
<a name="l00969"></a>00969         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7c1fa6a1a24755bfebf3182d3e384b83">m_gui_rig_properties_window</a> 
<a name="l00970"></a>00970             = std::unique_ptr&lt;GUI::RigEditorRigPropertiesWindow&gt;(<span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_g_u_i_1_1_rig_editor_rig_properties_window.html">GUI::RigEditorRigPropertiesWindow</a>(<span class="keyword">this</span>));
<a name="l00971"></a>00971     }
<a name="l00972"></a>00972     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a>.get() == <span class="keyword">nullptr</span>)
<a name="l00973"></a>00973     {
<a name="l00974"></a>00974         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa2bdcc0d7a5c976d217193d892c8af52">m_gui_land_vehicle_properties_window</a> 
<a name="l00975"></a>00975             = std::unique_ptr&lt;GUI::RigEditorLandVehiclePropertiesWindow&gt;(<span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_g_u_i_1_1_rig_editor_land_vehicle_properties_window.html">GUI::RigEditorLandVehiclePropertiesWindow</a>(<span class="keyword">this</span>));
<a name="l00976"></a>00976     }
<a name="l00977"></a>00977     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9b403eaeb6c960ffc6b452bf126b7b24">m_gui_help_window</a>.get() == <span class="keyword">nullptr</span>)
<a name="l00978"></a>00978     {
<a name="l00979"></a>00979         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a9b403eaeb6c960ffc6b452bf126b7b24">m_gui_help_window</a> = std::unique_ptr&lt;GUI::RigEditorHelpWindow&gt;(<span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_g_u_i_1_1_rig_editor_help_window.html">GUI::RigEditorHelpWindow</a>(<span class="keyword">this</span>));
<a name="l00980"></a>00980     }
<a name="l00981"></a>00981 }
<a name="l00982"></a>00982 
<a name="l00983"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab4ac10ccc82b0ac47abeee00ababe8aa">00983</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab4ac10ccc82b0ac47abeee00ababe8aa">Main::HideAllWheelGuiPanels</a>()
<a name="l00984"></a>00984 {
<a name="l00985"></a>00985     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a10352e1014c857538edadde05b71553f">m_meshwheels2_panel</a>-&gt;Hide();
<a name="l00986"></a>00986     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aa12d86a3aeb6fb58164c5d3d0204f6e6">m_flexbodywheels_panel</a>-&gt;Hide();
<a name="l00987"></a>00987 }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989 <span class="comment">// ----------------------------------------------------------------------------</span>
<a name="l00990"></a>00990 <span class="comment">// Rig Updaters</span>
<a name="l00991"></a>00991 <span class="comment">// ----------------------------------------------------------------------------</span>
<a name="l00992"></a>00992 
<a name="l00993"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aae179b2d917eadb22e6e806e5b1218c0">00993</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aae179b2d917eadb22e6e806e5b1218c0">Main::CommandRigSelectedNodesUpdateAttributes</a>(<span class="keyword">const</span> <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_nodes_data.html">RigAggregateNodesData</a>* data)
<a name="l00994"></a>00994 {
<a name="l00995"></a>00995     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#acf591ddaa7076f04007851ad52e4c2b5">SelectedNodesUpdateAttributes</a>(data);
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 
<a name="l00998"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8256e56d78527a665598fc29a40b6469">00998</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8256e56d78527a665598fc29a40b6469">Main::CommandRigSelectedPlainBeamsUpdateAttributes</a>(<span class="keyword">const</span> <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_plain_beams_data.html">RigAggregatePlainBeamsData</a>* data)
<a name="l00999"></a>00999 {
<a name="l01000"></a>01000     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ab26eeed75a6c2d466b38dda6a6a33bf6">SelectedPlainBeamsUpdateAttributes</a>(data);
<a name="l01001"></a>01001 }
<a name="l01002"></a>01002 
<a name="l01003"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a65bf3c0b56b01ea607f97bac4a7edd47">01003</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a65bf3c0b56b01ea607f97bac4a7edd47">Main::CommandRigSelectedShocksUpdateAttributes</a>(<span class="keyword">const</span> <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_shocks_data.html">RigAggregateShocksData</a>*     data)
<a name="l01004"></a>01004 {
<a name="l01005"></a>01005     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ad9eaca4efbd4e8cd82068ec443930855">SelectedShocksUpdateAttributes</a>(data);
<a name="l01006"></a>01006 }
<a name="l01007"></a>01007 
<a name="l01008"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a2b5781ac3dc16dea6aeace8abfc8824d">01008</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a2b5781ac3dc16dea6aeace8abfc8824d">Main::CommandRigSelectedShocks2UpdateAttributes</a>(<span class="keyword">const</span> <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_shocks2_data.html">RigAggregateShocks2Data</a>*    data)
<a name="l01009"></a>01009 {
<a name="l01010"></a>01010     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a27e7ce8036ce00f6f291430fe7501fd0">SelectedShocks2UpdateAttributes</a>(data);
<a name="l01011"></a>01011 }
<a name="l01012"></a>01012 
<a name="l01013"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8f9e8541ceace4ad3f0ce8b74741aaf4">01013</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a8f9e8541ceace4ad3f0ce8b74741aaf4">Main::CommandRigSelectedHydrosUpdateAttributes</a>(<span class="keyword">const</span> <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_hydros_data.html">RigAggregateHydrosData</a>*     data)
<a name="l01014"></a>01014 {
<a name="l01015"></a>01015     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a793f76a955eb9502b4b27aa3a7518faa">SelectedHydrosUpdateAttributes</a>(data);
<a name="l01016"></a>01016 }
<a name="l01017"></a>01017 
<a name="l01018"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1abd6df2d66916d21c59e0b41a27b8bf">01018</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a1abd6df2d66916d21c59e0b41a27b8bf">Main::CommandRigSelectedCommands2UpdateAttributes</a>(<span class="keyword">const</span> <a class="code" href="struct_ro_r_1_1_rig_editor_1_1_rig_aggregate_commands2_data.html">RigAggregateCommands2Data</a>*  data)
<a name="l01019"></a>01019 {
<a name="l01020"></a>01020     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#ab9b0d933fd613ade496b73b2bffb6a7c">SelectedCommands2UpdateAttributes</a>(data);
<a name="l01021"></a>01021 }
<a name="l01022"></a>01022 
<a name="l01023"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a23656895071cd6cf1367399c50c4e93f">01023</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a23656895071cd6cf1367399c50c4e93f">Main::CommandScheduleSetWheelSelected</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_land_vehicle_wheel.html">LandVehicleWheel</a>* wheel_ptr, <span class="keywordtype">int</span> wheel_index, <span class="keywordtype">bool</span> state_selected)
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> == <span class="keyword">nullptr</span>)
<a name="l01026"></a>01026     {
<a name="l01027"></a>01027         <span class="keywordflow">return</span>;
<a name="l01028"></a>01028     }
<a name="l01029"></a>01029     <span class="keyword">const</span> <span class="keywordtype">bool</span> selection_changes = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a8f6af01cfc287de12b9ce47085d5b531">ScheduleSetWheelSelected</a>(wheel_ptr, wheel_index, state_selected, <span class="keyword">this</span>);
<a name="l01030"></a>01030     <span class="keywordflow">if</span> (selection_changes)
<a name="l01031"></a>01031     {
<a name="l01032"></a>01032         <span class="keywordflow">if</span> (state_selected)
<a name="l01033"></a>01033         {
<a name="l01034"></a>01034             this-&gt;SetIsSelectWheelScheduled(<span class="keyword">true</span>);
<a name="l01035"></a>01035             this-&gt;SetIsDeselectWheelScheduled(<span class="keyword">false</span>);
<a name="l01036"></a>01036         }
<a name="l01037"></a>01037         <span class="keywordflow">else</span>
<a name="l01038"></a>01038         {
<a name="l01039"></a>01039             this-&gt;SetIsSelectWheelScheduled(<span class="keyword">false</span>);
<a name="l01040"></a>01040             this-&gt;SetIsDeselectWheelScheduled(<span class="keyword">true</span>);
<a name="l01041"></a>01041         }
<a name="l01042"></a>01042     }
<a name="l01043"></a>01043 }
<a name="l01044"></a>01044 
<a name="l01045"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aaf78367c03cea1e8dce1ab13add8e895">01045</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#aaf78367c03cea1e8dce1ab13add8e895">Main::CommandSetWheelHovered</a> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_land_vehicle_wheel.html">LandVehicleWheel</a>* wheel_ptr, <span class="keywordtype">int</span> wheel_index, <span class="keywordtype">bool</span> state_hovered)
<a name="l01046"></a>01046 {
<a name="l01047"></a>01047     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> == <span class="keyword">nullptr</span>)
<a name="l01048"></a>01048     {
<a name="l01049"></a>01049         <span class="keywordflow">return</span>;
<a name="l01050"></a>01050     }
<a name="l01051"></a>01051     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a12dded2aebfd4863a89aa63466dfd7a9">SetWheelHovered</a>(wheel_ptr, wheel_index, state_hovered, <span class="keyword">this</span>);
<a name="l01052"></a>01052 }
<a name="l01053"></a>01053 
<a name="l01054"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab79af9f428c0f7ad17b89813490e8564">01054</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab79af9f428c0f7ad17b89813490e8564">Main::CommandScheduleSetAllWheelsSelected</a>(<span class="keywordtype">bool</span> state_selected)
<a name="l01055"></a>01055 {
<a name="l01056"></a>01056     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> == <span class="keyword">nullptr</span>)
<a name="l01057"></a>01057     {
<a name="l01058"></a>01058         <span class="keywordflow">return</span>;
<a name="l01059"></a>01059     }
<a name="l01060"></a>01060     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#aa8aaa5a83ce47902feb5b60d2c0ef486">ScheduleSetAllWheelsSelected</a>(state_selected, <span class="keyword">this</span>))
<a name="l01061"></a>01061     {
<a name="l01062"></a>01062         <span class="keywordflow">if</span> (state_selected)
<a name="l01063"></a>01063         {
<a name="l01064"></a>01064             this-&gt;SetIsSelectAllWheelsScheduled(<span class="keyword">true</span>);
<a name="l01065"></a>01065             this-&gt;SetIsDeselectAllWheelsScheduled(<span class="keyword">false</span>);        
<a name="l01066"></a>01066         }
<a name="l01067"></a>01067         <span class="keywordflow">else</span>
<a name="l01068"></a>01068         {
<a name="l01069"></a>01069             this-&gt;SetIsSelectAllWheelsScheduled(<span class="keyword">false</span>);
<a name="l01070"></a>01070             this-&gt;SetIsDeselectAllWheelsScheduled(<span class="keyword">true</span>);
<a name="l01071"></a>01071         }
<a name="l01072"></a>01072     }
<a name="l01073"></a>01073 }
<a name="l01074"></a>01074 
<a name="l01075"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab3bd28bf21ae6f6c617a531fc03df4bb">01075</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ab3bd28bf21ae6f6c617a531fc03df4bb">Main::CommandSetAllWheelsHovered</a>(<span class="keywordtype">bool</span> state_hovered)
<a name="l01076"></a>01076 {
<a name="l01077"></a>01077     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l01078"></a>01078     {
<a name="l01079"></a>01079         <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a3a84e0664e3684eba2d400470ae9a92a">SetAllWheelsHovered</a>(state_hovered, <span class="keyword">this</span>);
<a name="l01080"></a>01080     }
<a name="l01081"></a>01081 }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 <span class="comment">// Utility macros for creating fresh empty rig + initial cube</span>
<a name="l01084"></a><a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">01084</a> <span class="preprocessor">#define ADD_NODE(MODULENAME, NODENAME, X, Y, Z) \</span>
<a name="l01085"></a>01085 <span class="preprocessor">{ \</span>
<a name="l01086"></a>01086 <span class="preprocessor">    RigDef::Node n; \</span>
<a name="l01087"></a>01087 <span class="preprocessor">    n.id.SetStr(NODENAME); \</span>
<a name="l01088"></a>01088 <span class="preprocessor">    n.position = Ogre::Vector3(X, Y, Z); \</span>
<a name="l01089"></a>01089 <span class="preprocessor">    MODULENAME-&gt;nodes.push_back(n); \</span>
<a name="l01090"></a>01090 <span class="preprocessor">}</span>
<a name="l01091"></a><a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">01091</a> <span class="preprocessor"></span><span class="preprocessor">#define LINK_NODES(MODULE, NODE1, NODE2)\</span>
<a name="l01092"></a>01092 <span class="preprocessor">{\</span>
<a name="l01093"></a>01093 <span class="preprocessor">    RigDef::Beam b;\</span>
<a name="l01094"></a>01094 <span class="preprocessor">    unsigned flags = RigDef::Node::Ref::REGULAR_STATE_IS_VALID | RigDef::Node::Ref::REGULAR_STATE_IS_NAMED; \</span>
<a name="l01095"></a>01095 <span class="preprocessor">    b.nodes[0] = RigDef::Node::Ref(NODE1, 0u, flags, 0);\</span>
<a name="l01096"></a>01096 <span class="preprocessor">    b.nodes[1] = RigDef::Node::Ref(NODE2, 0u, flags, 0);\</span>
<a name="l01097"></a>01097 <span class="preprocessor">    MODULE-&gt;beams.push_back(b);\</span>
<a name="l01098"></a>01098 <span class="preprocessor">}</span>
<a name="l01099"></a>01099 <span class="preprocessor"></span>
<a name="l01100"></a><a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad136bb804b1accbfed00705895f86362">01100</a> <span class="keywordtype">void</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#ad136bb804b1accbfed00705895f86362">Main::CommandCreateNewEmptyRig</a>()
<a name="l01101"></a>01101 {
<a name="l01102"></a>01102     <span class="keywordflow">if</span> (<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> != <span class="keyword">nullptr</span>)
<a name="l01103"></a>01103     {
<a name="l01104"></a>01104         <span class="keywordflow">return</span>;
<a name="l01105"></a>01105     }
<a name="l01106"></a>01106 
<a name="l01107"></a>01107     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a> = <span class="keyword">new</span> <a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html">RigEditor::Rig</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>);
<a name="l01108"></a>01108     <span class="comment">// Create definition</span>
<a name="l01109"></a>01109     <span class="keyword">auto</span> def = boost::shared_ptr&lt;RigDef::File&gt;(<span class="keyword">new</span> <a class="code" href="struct_rig_def_1_1_file.html">RigDef::File</a>());
<a name="l01110"></a>01110     def-&gt;name = <span class="stringliteral">&quot;Unnamed rig (created in editor)&quot;</span>;
<a name="l01111"></a>01111     <span class="keyword">auto</span> module = boost::shared_ptr&lt;RigDef::File::Module&gt;(<span class="keyword">new</span> <a class="code" href="struct_rig_def_1_1_file_1_1_module.html">RigDef::File::Module</a>(<span class="stringliteral">&quot;_Root_&quot;</span>));
<a name="l01112"></a>01112     def-&gt;root_module = module;
<a name="l01113"></a>01113     <span class="comment">// Create special node 0 in _Root_ module</span>
<a name="l01114"></a>01114     <a class="code" href="struct_rig_def_1_1_node.html">RigDef::Node</a> node_0;
<a name="l01115"></a>01115     node_0.<a class="code" href="struct_rig_def_1_1_node.html#a6becadb0fb729208ba9327f621561403">id</a>.<a class="code" href="class_rig_def_1_1_node_1_1_id.html#a30fc558c055857280fb2adba21a08eea">SetStr</a>(<span class="stringliteral">&quot;ZERO&quot;</span>);
<a name="l01116"></a>01116     node_0.<a class="code" href="struct_rig_def_1_1_node.html#ac760c8ef35c83b3eed3f284c161314e0">position</a> = Ogre::Vector3::ZERO;
<a name="l01117"></a>01117     module-&gt;nodes.push_back(node_0);
<a name="l01118"></a>01118     <span class="comment">// Create cube around node 0</span>
<a name="l01119"></a>01119     <span class="keywordtype">float</span> size = <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a827cbb121644d1b066ac3275a5481f74">m_config</a>-&gt;<a class="code" href="struct_ro_r_1_1_rig_editor_1_1_config.html#ac9bb4a9c097eb5e3549b18156d28c468">new_rig_initial_box_half_size</a>;
<a name="l01120"></a>01120     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_bottom_oo&quot;</span>, -size, -size, -size);
<a name="l01121"></a>01121     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xo&quot;</span>,  size, -size, -size);
<a name="l01122"></a>01122     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_bottom_ox&quot;</span>, -size, -size,  size);
<a name="l01123"></a>01123     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xx&quot;</span>,  size, -size,  size);
<a name="l01124"></a>01124     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_top_oo&quot;</span>,    -size,  size, -size);
<a name="l01125"></a>01125     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_top_xo&quot;</span>,     size,  size, -size);
<a name="l01126"></a>01126     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_top_ox&quot;</span>,    -size,  size,  size);
<a name="l01127"></a>01127     <a class="code" href="_rig_editor___main_8cpp.html#aad5412a23e7d7c0bc03795bb2b9fdddc">ADD_NODE</a>(module, <span class="stringliteral">&quot;CUBE_top_xx&quot;</span>,     size,  size,  size);
<a name="l01128"></a>01128     <span class="comment">// Link nodes                         </span>
<a name="l01129"></a>01129     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_oo&quot;</span>, <span class="stringliteral">&quot;CUBE_bottom_xo&quot;</span>); <span class="comment">// Bottom plane...</span>
<a name="l01130"></a>01130     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xo&quot;</span>, <span class="stringliteral">&quot;CUBE_bottom_xx&quot;</span>);
<a name="l01131"></a>01131     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xx&quot;</span>, <span class="stringliteral">&quot;CUBE_bottom_ox&quot;</span>);
<a name="l01132"></a>01132     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_ox&quot;</span>, <span class="stringliteral">&quot;CUBE_bottom_oo&quot;</span>);
<a name="l01133"></a>01133     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_oo&quot;</span>, <span class="stringliteral">&quot;CUBE_top_xo&quot;</span>); <span class="comment">// Top plane...</span>
<a name="l01134"></a>01134     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_xo&quot;</span>, <span class="stringliteral">&quot;CUBE_top_xx&quot;</span>);
<a name="l01135"></a>01135     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_xx&quot;</span>, <span class="stringliteral">&quot;CUBE_top_ox&quot;</span>);
<a name="l01136"></a>01136     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_ox&quot;</span>, <span class="stringliteral">&quot;CUBE_top_oo&quot;</span>);
<a name="l01137"></a>01137     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_oo&quot;</span>, <span class="stringliteral">&quot;CUBE_top_oo&quot;</span>); <span class="comment">// Top to bottom...</span>
<a name="l01138"></a>01138     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xo&quot;</span>, <span class="stringliteral">&quot;CUBE_top_xo&quot;</span>);
<a name="l01139"></a>01139     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_ox&quot;</span>, <span class="stringliteral">&quot;CUBE_top_ox&quot;</span>);
<a name="l01140"></a>01140     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xx&quot;</span>, <span class="stringliteral">&quot;CUBE_top_xx&quot;</span>);
<a name="l01141"></a>01141     <span class="comment">// Link node 0</span>
<a name="l01142"></a>01142     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_oo&quot;</span>, <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01143"></a>01143     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xo&quot;</span>, <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01144"></a>01144     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_ox&quot;</span>, <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01145"></a>01145     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_bottom_xx&quot;</span>, <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01146"></a>01146     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_oo&quot;</span>   , <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01147"></a>01147     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_xo&quot;</span>   , <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01148"></a>01148     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_ox&quot;</span>   , <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01149"></a>01149     <a class="code" href="_rig_editor___main_8cpp.html#ab04fc878411a1128f7d6ec3d9cb4f27a">LINK_NODES</a>(module, <span class="stringliteral">&quot;CUBE_top_xx&quot;</span>   , <span class="stringliteral">&quot;ZERO&quot;</span> );
<a name="l01150"></a>01150     <span class="comment">// Build</span>
<a name="l01151"></a>01151     <a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a897922451c3b8a91e312bf335891f5bf">m_rig</a>-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_rig.html#a313a85e2e173bd3d0ea38e5135f68e1b">Build</a>(def, <span class="keyword">this</span>, this-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;getRootSceneNode(), <span class="keyword">nullptr</span>);
<a name="l01152"></a>01152     <span class="comment">// Accomodate</span>
<a name="l01153"></a>01153     this-&gt;<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a7043ad34e928efff290d0b9f2192a613">OnNewRigCreatedOrLoaded</a>(<a class="code" href="class_ro_r_1_1_rig_editor_1_1_main.html#a66f2a5d8f0ce267b6a50bd6901046081">m_scene_manager</a>-&gt;getRootSceneNode());
<a name="l01154"></a>01154 }
<a name="l01155"></a>01155 
<a name="l01156"></a>01156 <span class="comment">// ----------------------------------------------------------------------------</span>
<a name="l01157"></a>01157 <span class="comment">// End</span>
<a name="l01158"></a>01158 <span class="comment">// ----------------------------------------------------------------------------</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Oct 12 2015 11:55:32 for Rigs of Rods by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
